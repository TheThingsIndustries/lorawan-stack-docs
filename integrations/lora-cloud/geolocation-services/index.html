<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.112.3">
  <title>LoRa Cloud Geolocation Services | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/geolocation-services/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.a66756cfe43ecf9e9bdf4eda3f7a6599499c94b1de904093e2d076c04af16f4b.css" integrity="sha256-pmdWz&#43;Q&#43;z56b307aP3plmUmclLHekECT4tB2wErxb0s=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="LoRa Cloud Geolocation Services">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="LoRa Cloud Geolocation Services">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/integrations/lora-cloud/geolocation-services/">
  <meta name="twitter:title" content="LoRa Cloud Geolocation Services" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NGRDCNM');</script>


</head>


<body>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NGRDCNM"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.26.1</p>
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/the-things-stack/">The Things Stack</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Integrations</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/integrations/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/adding-applications/" class="">Adding Applications</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/adding-integrations/" class="">Adding Integrations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/cloud-integrations/" class="">Cloud Integrations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/mqtt/" class="">MQTT Server</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/pubsub/" class="">Pub/Sub</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/" class="">LoRa Cloud</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/portal/" class="">LoRa Cloud Setup</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/geolocation-services/" class="is-active">LoRa Cloud Geolocation Services</a>
    
    



    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/modem-services/" class="">LoRa Cloud Modem Services</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/node-red/" class="">Node-RED</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/ifttt/" class="">IFTTT</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/guides/" class="">Guides</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/" class="">Payload Formatters</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/storage/" class="">Storage Integration</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/integrations/webhooks/" class="">Webhooks</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">LoRa Cloud Geolocation Services
          
        </h1>
        
        <div class="content">
          <p><a href="https://www.loracloud.com/portal/geolocation/home">LoRa Cloud Geolocation Services</a> provides simple JSON web APIs that can be easily integrated with a LoRaWAN network or application server to enable estimating the location of LoRa-based devices.</p>
<p>In general, LoRa allows locating devices withing approximately 50m, without the need for a geolocation hardware module and no extra power consumption. Instead, the RSSI, SNR and TOA metadata that are being sent as part of your device&rsquo;s LoRa radio frames are used to estimate the location of your device. If your device can perform WiFi scans, scanning results can also be used to estimate your device&rsquo;s location. This yields a significant cost reduction compared to GPS.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Keep in mind that TOA is available only in metadata of gateways that have appropriate high-resolution time-stamping features. Therefore, your gateway needs to support this feature in order for you to be able to use TOA-based geolocation features.
</div>

<p>Also, LoRa Cloud Geolocation integration allows estimating the location of LR1110-based devices with transceiver firmware from their GNSS scans.</p>
<p>Three query types are supported in scope of this integration and will be demonstrated below:</p>
<ul>
<li><a href="https://www.loracloud.com/documentation/geolocation?url=v3.html">LoRa TOA/RSSI</a> - allows computing the location estimates using TOA and/or RSSI information from a single or multiple LoRa frames (for all LoRa devices)</li>
<li><a href="https://www.loracloud.com/documentation/geolocation?url=gnss.html">GNSS</a> - location estimates are computed from the information contained in the GNSS scan result messages (NAV messages) (for LR1110 transceiver-based devices only)</li>
<li><a href="https://www.loracloud.com/documentation/geolocation?url=v2.html#singleframe-wi-fi-tdoa-request">TOA/WiFi</a> - the initial device location estimation is performed using the scanned WiFi access points, but if this estimation is not valid, another estimation is performed based on TOA metadata from device&rsquo;s LoRa radio frames (for all LoRa devices capable of performing WiFi scans)</li>
</ul>
<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  It is important to know that you can obtain the location estimates using LoRa Cloud Geolocation LoRa TOA/RSSI query only if the uplink messages sent by your end device are picked up by at least 3 LoRaWAN gateways. If this is not the case, you will see no errors in The Things Stack Console, but you will not see the <code>Location solved</code> message containing the location estimation results either.
</div>

<p>The location of your gateway has to be publicly available for this integration, as it participates in the process of computing the end device location. This is disabled in The Things Stack by default, because the application (and end device) owner does not have be the one providing the gateway coverage. If you own the gateway, it is safe for you to explicitly allow to publish its location.</p>
<p>To make the gateway location public, tick the <strong>Gateway location → Public</strong> box when <a href="https://www.thethingsindustries.com/docs/gateways/concepts/adding-gateways/">adding your gateway</a> in The Things Stack Console.</p>
<p>If your gateway is already added in The Things Stack Console, go to your gateway&rsquo;s settings, navigate to the <strong>Location</strong> tab on the left hand menu and tick the <strong>Privacy → Publish location</strong> box.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Using Semtech&rsquo;s <a href="https://lora-developers.semtech.com/library/tech-papers-and-guides/understanding-lora-basics-modem-e/">Modem-E firmware</a> is recommended for LR1110-based devices, hence using the <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/modem-services/">LoRa Cloud Modem Services integration</a> instead of LoRa Cloud Geolocation is also recommended.
</div>

<p>Before proceding with this guide, make sure you have completed the <a href="https://www.thethingsindustries.com/docs/integrations/lora-cloud/portal/">LoRa Cloud Setup</a> guide.</p>
<h2 id="configure-geolocation-integration">Configure Geolocation Integration</h2>
<p>To setup LoRa Cloud Geolocation integration, navigate to your application in The Things Stack.</p>
<p>On the left hand menu, select <strong>Integrations → LoRa Cloud</strong>. Click the <strong>Expand</strong> button next to the <strong>Geolocation services</strong>.</p>
<p>Next, copy the token you previously created in LoRa Cloud Modem &amp; Geolocation Services portal and paste it in the <strong>Token</strong> field.</p>
<figure><img src="../copy-token.png"
         alt="Copy the token from LoRa Cloud"/>
</figure>

<p>Choose the <strong>Query type</strong> depending on the type of data you want to use for estimating the location of your device. As mentioned earlier, you can choose <strong>LoRa TOA/RSSI</strong>, <strong>GNSS</strong> or <strong>TOA/WiFi</strong> query type.</p>
<p>If you choose <strong>LoRa TOA/RSSI</strong>, you also have an option to enable <strong>Multiframe</strong> location lookups. Multiframe mode allows using the sequence of radio frames (instead of just a single frame) to improve the device&rsquo;s location estimation accuracy. Multiframe mode is reported to be more accurate than averaging multiple location results calculated from several single radio frames. If you choose multiframe mode, you can also set the <strong>Multiframe window size</strong> to tell how many historical messages should be sent as part of the final request, and <strong>Multiframe time window</strong> as the maximum age of considered historical messages.</p>
<p>The setting for the Server URL points to the LoRa Cloud Modem &amp; Geolocation Services and is set by default. Changing this is unnecessary.</p>
<p>Finish by clicking the <strong>Set token</strong> button.</p>
<figure><img src="../paste-token-geolocation.png"
         alt="LoRa Cloud Geolocation integration"/>
</figure>

<h2 id="obtain-location-solutions">Obtain Location Solutions</h2>
<p>This section will show you how to obtain the location estimates using LoRa® TOA/RSSI, GNSS and TOA/WiFi query types.</p>
<p>After you obtain the location results, you can further integrate your The Things Stack application with other third-party IoT platforms to visualize them, etc.</p>
<h3 id="lora-toarssi">LoRa TOA/RSSI</h3>
<p>At this point, when your LoRa device sends any uplink message and it gets picked up by at least 3 gateways, you will notice the location estimation results present in the <code>Location solved</code> message in The Things Stack <strong>Live data</strong> tab, as shown below.</p>
<figure><img src="../toa-rssi.png"
         alt="LoRa TOA/RSSI location estimate"/>
</figure>

<p>Notice the <code>Source: LORA_RSSI_GEOLOCATION</code> which indicates the type of the query you chose for geolocation.</p>
<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  Keep in mind that if your device&rsquo;s uplink message was not picked up by at least 3 gateways, you will not see the Location solved message in The Things Stack <strong>Live data</strong> view, but you will not see any errors either.
</div>

<h3 id="gnss">GNSS</h3>
<p>When your LR1110 transceiver performs a GNSS scan and sends the resulting data in an uplink NAV message, you will see the location estimate present in the <code>Location solved</code> message in The Things Stack <strong>Live data</strong> tab, as shown below.</p>
<figure><img src="../gnss.png"
         alt="GNSS location estimate"/>
</figure>

<p>Notice the <code>Source: GPS</code> which indicates the type of the query you chose for geolocation.</p>
<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  For GNSS-based geolocation, the GNSS payload has to be valid. Otherwise, you will see an error similar to <code>Ignore invalid GNSS message payload: &lt;payload&gt;</code>. This is likely going to happen if you are not using LR1110-based device with transceiver firmware.
</div>

<h3 id="toawifi">TOA/WiFi</h3>
<p>When your LoRa device performs a WiFi scan and sends a resulting uplink message, the payload contains the MAC addresses of WiFi adapters and RSSIs of scanned WiFi networks. You need to decode this payload using the <a href="https://www.thethingsindustries.com/docs/integrations/payload-formatters/javascript/">uplink payload formatter function</a> in a way that the <code>decoded_payload</code> object that is a part of the <code>uplink_message</code> contains the access point records, like so:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="s2">&#34;decoded_payload&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;access_points&#34;</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;bssid&#34;</span><span class="o">:</span> <span class="s2">&#34;14:60:80:9a:19:58&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rssi&#34;</span><span class="o">:</span> <span class="o">-</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;bssid&#34;</span><span class="o">:</span> <span class="s2">&#34;fc:f5:28:7b:07:e5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;rssi&#34;</span><span class="o">:</span> <span class="o">-</span><span class="mi">80</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>If estimating the location based on WiFi access point records cannot be performed, the location will be estimated using the TOA information from LoRa radio metadata and gateway location. In both cases, you will see the location estimate present in the <code>Location solved</code> message in The Things Stack <strong>Live data</strong> tab, as shown below.</p>
<figure><img src="../toa-wifi.png"
         alt="TOA/WiFi location estimate"/>
</figure>

<p>Notice the <code>Source: WIFI_RSSI_GEOLOCATION</code> which indicates the type of the query you chose for geolocation.</p>
        </div>
        <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/integrations/lora-cloud/portal/">← LoRa Cloud Setup</a>
<a class="button is-pulled-right" href="/docs/integrations/lora-cloud/modem-services/">LoRa Cloud Modem Services →</a>
</div>

        <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#configure-geolocation-integration'>Configure Geolocation Integration</a></li>
    
      
      <li><a href='#obtain-location-solutions'>Obtain Location Solutions</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/the-things-stack/">The Things Stack</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Oliver Cvetkovski on 08 Mar 2023.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/ec58e18e80a5bb0f837b3064abd22b81482b7303">
      doc: Update LoRa Cloud integration docs (#1046)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/integrations/lora-cloud/geolocation-services.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.c601451bfe16c7a1f9f8a5874bf803042c24e8aaf36ffb7ab8f2f0b1fc2d6961.js" integrity="sha256-xgFFG/4Wx6H5&#43;KWHS/gDBCwk6Krzb/t6uPLwsfwtaWE=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
