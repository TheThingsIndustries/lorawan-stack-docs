<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.134.2">
  <title>Using CUPS to redirect to a different LNS | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/cups-forwarding/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.5ba0be8f5f0e953584382f5875ae6ec65f7a9a9cda0dea27bd9ddb1025d10fa5.css" integrity="sha256-W6C&#43;j18OlTWEOC9Yda5uxl96mpzaDeonvZ3bECXRD6U=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Using CUPS to redirect to a different LNS">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Using CUPS to redirect to a different LNS">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/cups-forwarding/">
  <meta property="og:image" content="/docs/docs-thumbnail.png"/>
  <meta name="twitter:title" content="Using CUPS to redirect to a different LNS" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NGRDCNM');</script>



  <link rel="stylesheet" href="https://ttui.thethingsindustries.com/release/1.10.1/main.css" />
</head>


<body class="theme-tts">


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NGRDCNM"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/the-things-stack/">The Things Stack</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
        <a class="navbar-item" href="/docs/api/">API</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://www.thethingsindustries.com/stack/plans/" target="_blank">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Gateways</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/gateways/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/" class="">Concepts</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/adding-gateways/" class="">Adding Gateways</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/" class="">LoRa Basics™ Station</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/cups/" class="">Configuration and Update Server (CUPS)</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/lns/" class="">LoRaWAN Network Server (LNS)</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/cups-forwarding/" class="is-active">Using CUPS to redirect to a different LNS</a>
    
    



    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/lora-basics-station/mtls-authentication/" class="">mTLS Authentication</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/udp/" class="">Semtech UDP Packet Forwarder</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/gateways/concepts/ttigw/" class="">The Things Industries Gateway Protocol</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/models/" class="">Models</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/troubleshooting/" class="">Troubleshooting Gateways</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Using CUPS to redirect to a different LNS
          
        </h1>
        
        <div class="content">
          <p>This section explains how redirect your gateway from one The Things Stack instance to another using CUPS, thus facilitating remote gateway management.</p>
<p>If your gateway is using <a href="/docs/gateways/concepts/lora-basics-station/cups/">CUPS</a> to connect to The Things Stack, and you want to redirect it from one The Things Stack instance to another, just follow the steps below. As an example, we consider redirecting a gateway from The Things Stack Sandbox to The Things Stack Cloud.</p>
<p>First, register your gateway in the target instance (The Things Stack Cloud in our example). You can choose to <strong>Generate API key for LNS</strong> upon registering, or to follow steps to create an <a href="/docs/gateways/concepts/lora-basics-station/cups/#create-separate-cups-and-lns-api-keys">LNS key</a> (gateway API key with linking rights) in the target instance after registering.</p>
<figure><img src="../target-instance-registration.png"
    alt="Registering gateway in the target The Things Stack instance">
</figure>

<p>Copy the LNS key from the target instance (that you created in previous step). In the source instance (The Things Stack Sandbox in our example), navigate to your gateway&rsquo;s <strong>General settings</strong> tab and paste the LNS key you&rsquo;ve copied in the <strong>LoRa Basics Station LNS Authentication Key</strong> field.</p>
<p>Navigate to your gateway&rsquo;s <strong>General settings</strong> tab in the target instance, copy the <strong>Gateway Server address</strong> and paste it in the <strong>Gateway Server address</strong> field of the source instance.</p>
<figure><img src="../change-lns-key-and-gs-addr.png"
    alt="Changing LNS key and GS address in the source instance">
</figure>

<p>You can optionally invalidate the old LNS key in the source instance, either by deleting it or by removing the linking right.</p>
<p>Upon the next CUPS request, the gateway will connect to the target The Things Stack instance and stop sending packets to the source instance. Usually, a CUPS request is sent every 24h, but in this case, it will happen sooner. Changing the Gateway Server address forces the gateway to reconnect in about 10 minutes on average. Also, invalidating the old LNS key in the source instance results in CUPS lookup being done before the 24h window finishes, during which the gateway will redirect to the target instance.</p>
        </div>
        <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/gateways/concepts/lora-basics-station/lns/">← LoRaWAN Network Server (LNS)</a>
<a class="button is-pulled-right" href="/docs/gateways/concepts/lora-basics-station/mtls-authentication/">mTLS Authentication →</a>
</div>

        <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    



  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-third">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/the-things-stack/">The Things Stack</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
        <p><a class="" href="/docs/api/">API</a></p>
      </nav>
      <nav class="column is-one-third">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
      </nav>
      
      <nav class="column is-one-third">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.3bf0da17f5ab4cc0f916662c2d2f977f7fa7259b4483f7f9eb46e875a556cc43.js" integrity="sha256-O/DaF/WrTMD5FmYsLS&#43;Xf3&#43;nJZtEg/f560bodaVWzEM=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
