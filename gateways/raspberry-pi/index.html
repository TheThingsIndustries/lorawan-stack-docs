<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.96.0" />
  <title>Bulding a gateway with Raspberry Pi and IC880A | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/gateways/raspberry-pi/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.74b07de880ad60ffdf0f356535e15d45e05de3df7f1c738e63521f7d8d731e53.css" integrity="sha256-dLB96ICtYP/fDzVlNeFdReBd499/HHOOY1IffY1zHlM=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Bulding a gateway with Raspberry Pi and IC880A">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Bulding a gateway with Raspberry Pi and IC880A">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/gateways/raspberry-pi/">
  <meta name="twitter:title" content="Bulding a gateway with Raspberry Pi and IC880A" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.20.1</p>
      </a><div class="navbar-item navbar-search-brand">
        <div class="field has-addons has-addons-centered">
          <div class="control">
            <input id="search-input-brand" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
          </div>
        </div>
      </div>
      
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a><div class="navbar-item navbar-search-menu">
            <div class="field has-addons has-addons-centered">
              <div class="control">
                <input id="search-input-menu" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
              </div>
            </div>
          </div></div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-brand',
      debug: false 
    });
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-menu',
      debug: false 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Gateways</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/gateways/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/adding-gateways/" class="">Adding Gateways</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/gateway-claiming/" class="">Gateway Claiming</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/troubleshooting/" class="">Troubleshooting Gateways</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/lora-basics-station/" class="">LoRa Basics™ Station</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/udp/" class="">Semtech UDP Packet Forwarder</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/raspberry-pi/" class="is-active">Bulding a gateway with Raspberry Pi and IC880A</a>
    



    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/browan-minihub-pro/" class="">Browan Minuhub Pro</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/ciscowirelessgateway/" class="">Cisco Wireless Gateway for LoRaWAN</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/cloudgate/" class="">CloudGate</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/dragino-lps8/" class="">Dragino LPS8</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/kerlinkwirnetistation/" class="">Kerlink Wirnet iStation</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/kerlinkwirnetstation/" class="">Kerlink Wirnet Station</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/laird-sentrius/" class="">Laird Sentrius™ RG1xx LoRaWAN Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/mikrotik-knot/" class="">MikroTik KNOT</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/mikrotik-ltap/" class="">MikroTik LtAP</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/mikrotikrouterboard/" class="">MikroTik Routerboard wAP LoRa8 kit</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/milesightug6x/" class="">Milesight UG6X LoRaWAN Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/milesightug8x/" class="">Milesight UG8X LoRaWAN Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/moko-mkgw2-lw/" class="">MOKOSMART MKGW2-LW LoRaWAN Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/multitechconduit/" class="">MultiTech Conduit AEP</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/multitechconduit-mlinux/" class="">MultiTech Conduit mLinux</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/nasysoutdoorgateway/" class="">NASys LoRaWAN Outdoor Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/rak-7240/" class="">RAK7240 WisGate Edge Prime</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/tektelickonamicro/" class="">Tektelic Kona Micro IoT LoRaWAN Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/thethingsindoorgateway/" class="">The Things Indoor Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/thethingskickstartergateway/" class="">The Things Kickstarter Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/thethingsoutdoor/" class="">The Things Outdoor Gateway</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/gateways/lorix-one/" class="">Wifx LORIX One</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Bulding a gateway with Raspberry Pi and IC880A
          
        </h1>
        
        <div class="content">
          <p>This guide can help you build your own LoRaWAN gateway using a Raspberry Pi and an iC880A LoRa concentrator board, and run LoRa Basics™ Station on it.</p>
<h2 id="requirements">Requirements</h2>
<figure class="float plain"><img src="hardware.png"
         alt="Required hardware parts"/>
</figure>

<p>For building this gateway you will need the following hardware elements:</p>
<ol>
<li><a href="https://shop.imst.de/wireless-modules/lora-products/8/ic880a-spi-lorawan-concentrator-868-mhz">iC880A-SPI concentrator board</a></li>
<li>3.5dBi - 7.5dBi antenna</li>
<li><a href="https://shop.imst.de/wireless-modules/accessories/20/u.fl-to-sma-pigtail-cable-for-ic880a-spi">iC880A pigtail for antenna</a></li>
<li>Raspberry Pi Model 2 or newer</li>
<li>2.5A power supply with micro USB connector</li>
<li>MicroSD Card with minimum 4GB of storage</li>
<li>7x dual female jumper wires</li>
<li>Ethernet cable or WiFi dongle (if using Raspberry PI 3+ this isn&rsquo;t required, because it has an integrated WiFi interface)</li>
</ol>
<h2 id="gateway-assembly">Gateway Assembly</h2>
<p>First, attach the antenna on the iC880A board using the pigtail cable.</p>
<p>Then use jumper cables to connect the iC880A pins to Raspberry Pi pins. Refer to the table below for connections between pins:</p>
<table>
<thead>
<tr>
<th>iC880A pin</th>
<th>Raspberry Pi pin</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>21</td>
<td>2</td>
<td>5V power supply</td>
</tr>
<tr>
<td>22</td>
<td>6</td>
<td>GND</td>
</tr>
<tr>
<td>13</td>
<td>22</td>
<td>Reset</td>
</tr>
<tr>
<td>14</td>
<td>23</td>
<td>SPI Clock</td>
</tr>
<tr>
<td>15</td>
<td>21</td>
<td>MISO</td>
</tr>
<tr>
<td>16</td>
<td>19</td>
<td>MOSI</td>
</tr>
<tr>
<td>17</td>
<td>24</td>
<td>NSS</td>
</tr>
</tbody>
</table>
<p>Your assembled gateway should look like on the image below.</p>
<figure><img src="cables.jpg"
         alt="Gateway assembly"/>
</figure>

<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  Do not power up your Raspberry Pi if you haven&rsquo;t connected the antenna to iC880A. If you power it up and the antenna is not connected, all transmit energy that was supposed to be radiated through antenna will be reflected back from an unterminated antenna port and dissipated as heat, and might damage your Raspberry Pi.
</div>

<h2 id="install-raspberry-pi-os-on-raspberry-pi">Install Raspberry Pi OS on Raspberry Pi</h2>
<p>In this step, you need to insert your Raspberry PI&rsquo;s SD card into your computer. Check out the official Raspberry Pi documentation for steps to <a href="https://www.raspberrypi.com/software/">install the Raspberry Pi 0S</a> on the SD card. The most common method to install the Raspberry Pi OS is using the Raspberry Pi Imager.</p>
<p>We also recommend to enable a default SSH access on your Raspberry Pi, in order to avoid connecting it to an external screen for the initial setup. Just mount the boot partition of your Raspberry Pi&rsquo;s SD card and create an empty file called <code>ssh</code>. For example, if using Linux:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">touch /media/<span class="nv">$USER</span>/boot/ssh
</span></span></code></pre></div><p>Visit the official Raspberry Pi documentation page on detailed guide for <a href="https://www.raspberrypi.com/documentation/computers/remote-access.html">enabling remote access</a>.</p>
<h2 id="boot-and-configure-your-raspberry-pi">Boot and Configure Your Raspberry Pi</h2>
<p>Plug the SD card back into your Raspberry Pi and power it up.</p>
<p>If you haven&rsquo;t enabled SSH access to your Raspberry Pi, you will need to connect an external screen and an external keyboard to it in order to configure it.</p>
<p>If you enabled SSH in the previous step, you can connect to your Raspberry Pi remotely from your computer - find out your Raspberry Pi&rsquo;s IP address by listing devices on your local network (for example with <code>nmap</code>) and connect via SSH. The default username is <code>pi</code> and the default password is <code>raspberry</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh pi@192.168.1.2
</span></span></code></pre></div><p>After logging in in your Raspberry Pi, upgrade the system packages to the latest versions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get upgrade
</span></span></code></pre></div><p>Enable the SPI interface by running the <code>raspi-config</code> tool:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo raspi-config
</span></span></code></pre></div><p>A <code>raspi-config</code> wizard will appear, so use the arrow keys and the Enter key to navigate through it. Choose <strong>Interface Options → SPI</strong>, then select <strong><Yes></strong> to enable the SPI interface. After enabling the SPI interface, hit the Escape key to exit the <code>raspi-config</code> tool.</p>
<p>Now install packages needed to build the packet forwarder:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install git gcc make
</span></span></code></pre></div><h2 id="build-the-lora-basics-station-packet-forwarder">Build the LoRa Basics™ Station Packet Forwarder</h2>
<p>First, clone the The Things Stack repository:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/lorabasics/basicstation
</span></span></code></pre></div><p>Then build the LoRa Basics™ Station binary:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> basicstation
</span></span><span class="line"><span class="cl">make <span class="nv">platform</span><span class="o">=</span>rpi <span class="nv">variant</span><span class="o">=</span>std <span class="nv">ARCH</span><span class="o">=</span><span class="k">$(</span>gcc --print-multiarch<span class="k">)</span>
</span></span></code></pre></div><p>Make sure the binary was successfully built:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">./build-rpi-std/bin/station --version
</span></span></code></pre></div><p>The binary was successfully built if you see something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Station: 2.0.6<span class="o">(</span>rpi/std<span class="o">)</span> 2022-03-26 17:43:16
</span></span><span class="line"><span class="cl">Package: <span class="o">(</span>null<span class="o">)</span>
</span></span></code></pre></div><p>Now install the LoRa Basics™ Station binary:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo mkdir -p /opt/ttn-station/bin
</span></span><span class="line"><span class="cl">sudo cp ./build-rpi-std/bin/station /opt/ttn-station/bin/station
</span></span></code></pre></div><h2 id="derive-the-gateway-eui">Derive the Gateway EUI</h2>
<p>To derive the gateway EUI, you can use a combination of the gateway&rsquo;s MAC address and <code>FFFE</code>, as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">MAC</span><span class="o">=</span><span class="sb">`</span>cat /sys/class/net/eth0/address<span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EUI</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$MAC</span> <span class="p">|</span> awk -F: <span class="s1">&#39;{print $1$2$3 &#34;fffe&#34; $4$5$6}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The Gateway EUI is </span><span class="nv">$EUI</span><span class="s2">&#34;</span>
</span></span></code></pre></div><p>The output will look something like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">The Gateway EUI is b827ebfffee00c83
</span></span></code></pre></div><p>Make sure you write it down for further steps.</p>
<h2 id="register-the-gateway-on-the-things-stack">Register the Gateway on The Things Stack</h2>
<p>To register your gateway on The Things Stack, follow the process described in the <a href="https://www.thethingsindustries.com/docs/gateways/adding-gateways/">Adding Gateways</a> section. For the <strong>Gateway EUI</strong>, use the EUI that was derived in the previous step.</p>
<p>While registering, it is also recommended to enable the <strong>Require authenticated connection</strong> option.</p>
<h2 id="create-an-api-key">Create an API Key</h2>
<p>Next, you need to create an API key for your gateway on The Things Stack, which will be used for your gateway&rsquo;s authentication.</p>
<p>Follow the instructions in the <a href="https://www.thethingsindustries.com/docs/gateways/lora-basics-station/lns/#create-an-api-key">LNS</a> section to create an API key with the <strong>Link as Gateway to a Gateway Server for traffic exchange, i.e. write uplink and read downlink</strong> right. Make sure to copy the key as you will not be able to see it again.</p>
<h2 id="configure-lora-basics-station">Configure LoRa Basics™ Station</h2>
<p>The next step is to create the configuration files required for LoRa Basics™ Station gateway to connect to The Things Stack.</p>
<p>On your Raspberry Pi, create a new directory:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo mkdir -p /opt/ttn-station/config
</span></span></code></pre></div><p>Create a configuration file <code>tc.uri</code> containing an LNS server address. For example, if using <code>eu1</code> cluster of The Things Stack Community Edition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;wss://eu1.cloud.thethings.network:8887&#39;</span> <span class="p">|</span> sudo tee /opt/ttn-station/config/tc.uri
</span></span></code></pre></div><p>See <a href="https://www.thethingsindustries.com/docs/getting-started/server-addresses/">Server Addresses</a> if you are not sure which server address to use. See also <a href="https://www.thethingsindustries.com/docs/gateways/lora-basics-station/lns/#lns-server-address">LNS Server Address</a> for info about LNS server address format.</p>
<p>Next, create the <code>tc.key</code> configuration file containing an authorization header. This header will contain the API Key you created in the previous step, and it will be used to authenticate your gateway&rsquo;s connection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">API_KEY</span><span class="o">=</span><span class="s2">&#34;NNSXS.XXXXXXXXXXXXXXX.YYYYYYYYYYYYYYYY&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Authorization: Bearer </span><span class="nv">$API_KEY</span><span class="s2">&#34;</span> <span class="p">|</span> perl -p -e <span class="s1">&#39;s/\r\n|\n|\r/\r\n/g&#39;</span> <span class="p">|</span> sudo tee -a /opt/ttn-station/config/tc.key
</span></span></code></pre></div><p>Create the <code>tc.trust</code> configuration file that will be the root CA used to check your LNS server&rsquo;s certificates. You can use the system CA certificates:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo ln -s /etc/ssl/certs/ca-certificates.crt /opt/ttn-station/config/tc.trust
</span></span></code></pre></div><p>Now, create the <code>station.conf</code> configuration file containing configuration options for your concentrator:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">{
</span></span></span><span class="line"><span class="cl"><span class="s1">    /* If slave-X.conf present this acts as default settings */
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;SX1301_conf&#34;: { /* Actual channel plan is controlled by server */
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;lorawan_public&#34;: true, /* is default */
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;clksrc&#34;: 1, /* radio_1 provides clock to concentrator */
</span></span></span><span class="line"><span class="cl"><span class="s1">        /* path to the SPI device, un-comment if not specified on the command line e.g., RADIODEV=/dev/spidev0.0 */
</span></span></span><span class="line"><span class="cl"><span class="s1">        /*&#34;device&#34;: &#34;/dev/spidev0.0&#34;,*/
</span></span></span><span class="line"><span class="cl"><span class="s1">        /* freq/enable provided by LNS - only HW specific settings listed here */
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;radio_0&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;type&#34;: &#34;SX1257&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;rssi_offset&#34;: -166.0,
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;tx_enable&#34;: true,
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;antenna_gain&#34;: 0
</span></span></span><span class="line"><span class="cl"><span class="s1">        },
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;radio_1&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;type&#34;: &#34;SX1257&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;rssi_offset&#34;: -166.0,
</span></span></span><span class="line"><span class="cl"><span class="s1">            &#34;tx_enable&#34;: false
</span></span></span><span class="line"><span class="cl"><span class="s1">        }
</span></span></span><span class="line"><span class="cl"><span class="s1">        /* chan_multiSF_X, chan_Lora_std, chan_FSK provided by LNS */
</span></span></span><span class="line"><span class="cl"><span class="s1">    },
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#34;station_conf&#34;: {
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;routerid&#34;: &#34;&#39;</span><span class="s2">&#34;</span><span class="nv">$EUI</span><span class="s2">&#34;</span><span class="s1">&#39;&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;log_file&#34;: &#34;stderr&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;log_level&#34;: &#34;DEBUG&#34;, /* XDEBUG,DEBUG,VERBOSE,INFO,NOTICE,WARNING,ERROR,CRITICAL */
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;log_size&#34;: 10000000,
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;log_rotate&#34;: 3,
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#34;CUPS_RESYNC_INTV&#34;: &#34;1s&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">    }
</span></span></span><span class="line"><span class="cl"><span class="s1">}
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;</span> <span class="p">|</span> sudo tee /opt/ttn-station/config/station.conf
</span></span></code></pre></div><p>Finally, create the <code>start.sh</code> script, that will be used to reset the iC880A via its reset pin and start the packet forwarder:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"># Reset iC880a PIN
</span></span></span><span class="line"><span class="cl"><span class="s1">SX1301_RESET_BCM_PIN=25
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;$SX1301_RESET_BCM_PIN&#34;  &gt; /sys/class/gpio/export
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;out&#34; &gt; /sys/class/gpio/gpio$SX1301_RESET_BCM_PIN/direction
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;0&#34;   &gt; /sys/class/gpio/gpio$SX1301_RESET_BCM_PIN/value
</span></span></span><span class="line"><span class="cl"><span class="s1">sleep 0.1
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;1&#34;   &gt; /sys/class/gpio/gpio$SX1301_RESET_BCM_PIN/value
</span></span></span><span class="line"><span class="cl"><span class="s1">sleep 0.1
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;0&#34;   &gt; /sys/class/gpio/gpio$SX1301_RESET_BCM_PIN/value
</span></span></span><span class="line"><span class="cl"><span class="s1">sleep 0.1
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;$SX1301_RESET_BCM_PIN&#34;  &gt; /sys/class/gpio/unexport
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"># Test the connection, wait if needed.
</span></span></span><span class="line"><span class="cl"><span class="s1">while [[ $(ping -c1 google.com 2&gt;&amp;1 | grep &#34; 0% packet loss&#34;) == &#34;&#34; ]]; do
</span></span></span><span class="line"><span class="cl"><span class="s1">echo &#34;[TTN Gateway]: Waiting for internet connection...&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">sleep 30
</span></span></span><span class="line"><span class="cl"><span class="s1">done
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"># Start station
</span></span></span><span class="line"><span class="cl"><span class="s1">/opt/ttn-station/bin/station
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;</span> <span class="p">|</span> sudo tee /opt/ttn-station/bin/start.sh
</span></span></code></pre></div><p>You can check if your <code>start.sh</code> script is executable with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo chmod +x /opt/ttn-station/bin/start.sh
</span></span></code></pre></div><h2 id="test-the-packet-forwarder">Test the Packet Forwarder</h2>
<p>Start the packet fowarder with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> /opt/ttn-station/config
</span></span><span class="line"><span class="cl">sudo <span class="nv">RADIODEV</span><span class="o">=</span>/dev/spidev0.0 /opt/ttn-station/bin/start.sh
</span></span></code></pre></div><p>This will initialize the concentrator board, connect your gateway to The Things Stack, fetch the configuration based on your frequency plan and start listening for packets. If you notice something like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">2022-03-27 02:11:50.009 <span class="o">[</span>S2E:VERB<span class="o">]</span> RX 867.5MHz DR5 SF7/BW125 <span class="nv">snr</span><span class="o">=</span>6.2 <span class="nv">rssi</span><span class="o">=</span>-103 <span class="nv">xtime</span><span class="o">=</span>0xE0000000E34FB4 - updf <span class="nv">mhdr</span><span class="o">=</span><span class="m">40</span> <span class="nv">DevAddr</span><span class="o">=</span>260B0748 <span class="nv">FCtrl</span><span class="o">=</span><span class="m">00</span> <span class="nv">FCnt</span><span class="o">=</span><span class="m">35</span> <span class="nv">FOpts</span><span class="o">=[]</span> 014A <span class="nv">mic</span><span class="o">=</span><span class="m">1717970429</span> <span class="o">(</span><span class="m">14</span> bytes<span class="o">)</span>
</span></span><span class="line"><span class="cl">2022-03-27 02:12:06.130 <span class="o">[</span>S2E:VERB<span class="o">]</span> RX 867.3MHz DR5 SF7/BW125 <span class="nv">snr</span><span class="o">=</span>8.0 <span class="nv">rssi</span><span class="o">=</span>-102 <span class="nv">xtime</span><span class="o">=</span>0xE0000001D92CCB - updf <span class="nv">mhdr</span><span class="o">=</span><span class="m">40</span> <span class="nv">DevAddr</span><span class="o">=</span>260B0748 <span class="nv">FCtrl</span><span class="o">=</span><span class="m">00</span> <span class="nv">FCnt</span><span class="o">=</span><span class="m">36</span> <span class="nv">FOpts</span><span class="o">=[]</span> 01EA <span class="nv">mic</span><span class="o">=</span><span class="m">463407879</span> <span class="o">(</span><span class="m">14</span> bytes<span class="o">)</span>
</span></span></code></pre></div><p>in the packet forwarder logs, it means your gateway has started picking up messages, Of course, this is possible if there are end devices transmitting data within the gateway&rsquo;s reach.</p>
<p>If you go to The Things Stack Console and navigate to your gateway&rsquo;s <strong>Live Data</strong> view, it will appear as connected and you will see uplink messages arriving.</p>
<h2 id="run-the-packet-forwarder-as-a-system-service">Run the Packet Forwarder as a System Service</h2>
<p>The only thing left to do is to configure the packet forwarder to run as a system service on Raspberry Pi. This ensures that the forwarder will start automatically after the Raspberry Pi boots.</p>
<p>First, create the <code>systemd</code> service configuration file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">[Unit]
</span></span></span><span class="line"><span class="cl"><span class="s1">Description=The Things Network Gateway
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">[Service]
</span></span></span><span class="line"><span class="cl"><span class="s1">WorkingDirectory=/opt/ttn-station/config
</span></span></span><span class="line"><span class="cl"><span class="s1">ExecStart=/opt/ttn-station/bin/start.sh
</span></span></span><span class="line"><span class="cl"><span class="s1">SyslogIdentifier=ttn-station
</span></span></span><span class="line"><span class="cl"><span class="s1">Restart=on-failure
</span></span></span><span class="line"><span class="cl"><span class="s1">RestartSec=5
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">[Install]
</span></span></span><span class="line"><span class="cl"><span class="s1">WantedBy=multi-user.target
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;</span> <span class="p">|</span> sudo tee /lib/systemd/system/ttn-station.service
</span></span></code></pre></div><p>Enable the service with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl <span class="nb">enable</span> ttn-station
</span></span></code></pre></div><p>Start the service:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo systemctl start ttn-station
</span></span></code></pre></div><p>You can observe the packet forwarder logs using the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo journalctl -f -u ttn-station
</span></span></code></pre></div><p>Voilà! Your gateway is now fully functional and you can start developing your IoT use case.</p>
        </div>
        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/gateways/udp/">← Semtech UDP Packet Forwarder</a>
<a class="button is-pulled-right" href="/docs/gateways/browan-minihub-pro/">Browan Minuhub Pro →</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#requirements'>Requirements</a></li>
    
      
      <li><a href='#gateway-assembly'>Gateway Assembly</a></li>
    
      
      <li><a href='#install-raspberry-pi-os-on-raspberry-pi'>Install Raspberry Pi OS on Raspberry Pi</a></li>
    
      
      <li><a href='#boot-and-configure-your-raspberry-pi'>Boot and Configure Your Raspberry Pi</a></li>
    
      
      <li><a href='#build-the-lora-basics-station-packet-forwarder'>Build the LoRa Basics™ Station Packet Forwarder</a></li>
    
      
      <li><a href='#derive-the-gateway-eui'>Derive the Gateway EUI</a></li>
    
      
      <li><a href='#register-the-gateway-on-the-things-stack'>Register the Gateway on The Things Stack</a></li>
    
      
      <li><a href='#create-an-api-key'>Create an API Key</a></li>
    
      
      <li><a href='#configure-lora-basics-station'>Configure LoRa Basics™ Station</a></li>
    
      
      <li><a href='#test-the-packet-forwarder'>Test the Packet Forwarder</a></li>
    
      
      <li><a href='#run-the-packet-forwarder-as-a-system-service'>Run the Packet Forwarder as a System Service</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Nejra Selimović on 18 May 2022.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/064f76f6740bcbb910f14704cd5cde36211d0f82">
      doc: Add RPI&#43;iC880A gateway doc (#852)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/gateways/raspberry-pi/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.a32708c8796e7e8713fa926212adddbbf5c15cdd97676d898ecfc17bc6d9ed4f.js" integrity="sha256-oycIyHlufocT&#43;pJiEq3du/XBXN2XZ22Jjs/Be8bZ7U8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
