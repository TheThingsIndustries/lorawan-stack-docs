<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Packet Broker | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/reference/packet-broker/" />
  <link rel="alternate icon" href="/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.4a91a2bdbdbc4e92cae68733965ef7b28a6ab235c8c20ea25b693218b6f87f06.css" integrity="sha256-SpGivb28TpLK5oczll73sopqsjXIwg6iW2kyGLb4fwY=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Packet Broker">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Packet Broker">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/reference/packet-broker/">
  <meta name="twitter:title" content="Packet Broker" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>
<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div id="migration-info">
      <div id="migration-text">thethingsstack.io has moved to thethingsindustries.com/docs</div>
      <div id="migration-button" class="button is-primary">Got it</div>
  </div>
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.12</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="/docs/download/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav>
<section class="search-container">
    <div class="container">
      <div class="columns is-vcentered">
        <div class="column">
          <div class="field has-addons has-addons-centered">
            <div class="control">
              <input class="input search-bar" id="search-input" type="text" placeholder="Search" type="text">
            </div>
          </div>
        </div>
      </div>
    </div>
</section>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: "4372282a02970d8402d43457bf95d486",
indexName: "thethingsstack",
inputSelector: '#search-input',
debug: false 
});
</script>
<div class="container" role="document">
  <div class="columns my-0">
      <div class="column is-one-fifth-tablet is-one-third sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Reference</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/reference/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/stripe/" class="">Billing with Stripe</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/api/" class="">API</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/application-packages/" class="">Application Packages</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/cli/" class="">Command-Line Interface</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/components/" class="">Components</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/configuration/" class="">Configuration</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/data-formats/" class="">Data Formats</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/email-templates/" class="">Email Templates</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/federated-auth/" class="">Federated Authentication</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/frequency-plans/" class="">Frequency Plans</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/glossary/" class="">Glossary</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/id-eui-constraints/" class="">ID and EUI Constraints</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/interop-repository/" class="">Interoperability Repository</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/spec-regional-parameters/" class="">LoRaWAN Specification and Regional Parameters</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/networking/" class="">Networking</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/" class="is-active">Packet Broker</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/connect/" class="">Connect</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/reference/packet-broker/configure/" class="">Configure</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/rate-limiting/" class="">Rate Limiting</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/root-certificates/" class="">Root Certificates</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/telemetry/" class="">Telemetry</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/reference/branding/" class="">Web UI Branding</a>
  </li>
</ul>



</nav>








      </div>
      <div class="column sidebar-middle">

<div class="docs-content">
<h1 class="title is-size-2">Packet Broker
  
  
  
  
</h1>

<div class="content">
  
<h2 id="what-is-it">What is it?&nbsp;<a class="header-hash" href="#what-is-it">#</a> </h2>
<p>Packet Broker can be used to exchange traffic with other LoRaWAN networks to share coverage and improve the overall network performance.</p>
<p><img src="overview.png" alt="Overview"></p>
<p>Packet Broker supports class A and C downlink as well as OTAA device activations.</p>
<h2 id="who-is-it-for">Who is it for?&nbsp;<a class="header-hash" href="#who-is-it-for">#</a> </h2>
<p>Exchanging traffic can be beneficial for all public and private LoRaWAN network operators: it can improve overall network performance by increasing resilience against gateway failures, expanding coverage area and optimizing end device battery life by communicating with the nearest gateways.</p>
<h3 id="typical-use-cases">Typical Use Cases&nbsp;<a class="header-hash" href="#typical-use-cases">#</a> </h3>
<ol>
<li>Forward uplink traffic received by your gateways from devices to their home network. The home network may also use your gateways to transmit downlink traffic to their devices. You can also put commercial agreements in place to monetize coverage.</li>
<li>Receive uplink traffic for your devices from other networks, and use those other networks to transmit downlink traffic to your end devices.</li>
</ol>
<h2 id="how-does-it-work">How Does it Work?&nbsp;<a class="header-hash" href="#how-does-it-work">#</a> </h2>
<p>Packet Broker distinguishes two types of networks: Forwarders and Home Networks. Forwarders are networks with gateways: they forward uplink messages from the gateways to Packet Broker, and downlink messages from Packet Broker back to the gateways. Home Networks are networks with end devices.</p>
<p>Your The Things Stack deployment can be a Forwarder, a Home Network or both. This means that you can make your physical gateway infrastructure available to other networks without having end devices. Likewise, you can deploy end devices as a Home Network, without physical gateway infrastructure.</p>
<p>Packet Broker routes uplink messages from Forwarders to Home Networks based on the 32-bit <code>DevAddr</code> in the uplink message. The first part of the <code>DevAddr</code> is the <code>NetID</code>, a globally unique identifier of a LoRaWAN network. Packet Broker uses the <code>NetID</code> to lookup the Home Network. Besides identifying Home Networks by <code>NetID</code>, Packet Broker also supports tenants. Tenants use a <code>DevAddr</code> block of a Home Network host.</p>
<blockquote>
<p>For example, a message with <code>DevAddr</code> <code>27ABCD12</code> has <code>NetID</code> <code>000013</code> (owned by The Things Network Foundation). The <code>DevAddr</code> block <code>27ABCD00</code> to <code>27ABCDFF</code> might be assigned to a private network <code>example-com</code>. That <code>DevAddr</code> block is noted as <code>27ABCD00/24</code>: 24 significant bits. Packet Broker identifies the Home Network then as <code>NetID</code> <code>000013</code> and tenant ID <code>example-com</code>.</p>
</blockquote>
<div class="notification is-primary is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Info:</h5>
  The Things Network is identified by <code>NetID</code> is <code>000013</code> and tenant ID <code>ttn</code>.
</div>

<h3 id="routing-policies">Routing Policies&nbsp;<a class="header-hash" href="#routing-policies">#</a> </h3>
<p>Routing policies define the rules that Forwarders configure for routing messages to Home Networks. Routing policies are peer-to-peer: a Forwarder can define policies with each individual Home Network. Forwarders can also define an optional default routing policy that is used as a fallback when no specific policy is defined.</p>
<p>Forwarders can configure the following things in a routing policy:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Uplink</th>
<th align="center">Downlink</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Join</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Join-request (uplink) and join-accept (downlink) messages</td>
</tr>
<tr>
<td>MAC payload</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Data messages with <code>FPort</code> <code>0</code> (for network layer instructions)</td>
</tr>
<tr>
<td>Application payload</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Data messages with <code>FPort</code> <code>1</code> or higher (for application layer payload)</td>
</tr>
<tr>
<td>Signal quality</td>
<td align="center">O</td>
<td align="center"></td>
<td>RSSI and SNR information</td>
</tr>
<tr>
<td>Localization</td>
<td align="center">O</td>
<td align="center"></td>
<td>Gateway locations, timestamps and signal quality</td>
</tr>
</tbody>
</table>
<blockquote>
<p>For instance, a Forwarder may wish to configure three policies:</p>
<ol>
<li>With Home Network that has <code>NetID</code> <code>000013</code> and tenant ID <code>ttn</code> (The Things Network): all message types. This would mean to forward join-requests and join-accepts, uplink and downlink MAC and application payload messages, and signal quality and localization information.</li>
<li>With Home Network that has <code>NetID</code> <code>000013</code> and tenant ID <code>example-com</code>: only join-requests, join-accepts and uplink and downlink MAC and application payload messages. This would mean to not forward the metadata.</li>
<li>A default policy (for all other networks): only uplink MAC and application payload messages. That would mean to not forward join-requests and join-accepts, and to not forward the metadata.</li>
</ol>
</blockquote>
<h2 id="getting-started">Getting Started&nbsp;<a class="header-hash" href="#getting-started">#</a> </h2>
<p>The Things Stack Community Edition or The Things Stack Cloud 





  

  

  

<a href="/docs/download" target="_blank" class="badge-stack has-tooltip has-tooltip-arrow has-tooltip-light" data-tooltip="Cloud, Community and Dedicated Cloud Only">
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_cloud.svg"></img>
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_ttn.svg"></img>
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_dedicated_cloud.svg"></img>
  
</a>


 is already connected to Packet Broker. Proceed to <a href="/docs/reference/packet-broker/configure/">Configure</a> section to manage your registration and routing policies with other networks.</p>
<p>When you are using The Things Stack Community Edition 





  

<a href="/docs/download" target="_blank" class="badge-stack has-tooltip has-tooltip-arrow has-tooltip-light" data-tooltip="Community Only">
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_ttn.svg"></img>
  
</a>


, you cannot configure any routing policies, as The Things Stack Community Edition is a public network and The Things Network Foundation controls which public or private networks the traffic gets exchanged with. To manage routing policies for your gateways, upgrade to The Things Stack Cloud.</p>
<p>When using The Things Stack Enterprise of The Things Stack Open Source, learn to <a href="/docs/reference/packet-broker/connect/">Connect The Things Stack to Packet Broker</a>. 





  

  

<a href="/docs/download" target="_blank" class="badge-stack has-tooltip has-tooltip-arrow has-tooltip-light" data-tooltip="Enterprise and Open Source Only">
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_enterprise.svg"></img>
  
    
    <img class="badge" src="/docs/img/tts_frames/frame_open_source.svg"></img>
  
</a>


</p>
<h2 id="lorawan-roaming-vs-packet-broker">LoRaWAN Roaming vs Packet Broker&nbsp;<a class="header-hash" href="#lorawan-roaming-vs-packet-broker">#</a> </h2>
<p>Packet Broker is a global backbone for LoRaWAN traffic. It is designed to securely exchange traffic between LoRaWAN networks.</p>
<p>Packet Broker supports LoRaWAN passive roaming, but it goes even beyond that:</p>
<ul>
<li>Packet Broker allows for individual packet selection: networks do not get charged for traffic they did not consume.</li>
<li>Packet Broker separates traffic routing from billing and clearing: networks are free to put commercial agreements in place to settle balances.</li>
<li>Packet Broker separates payload from metadata: networks only get charged for the value they need.</li>
<li>The Things Stack has native support for Packet Broker and can access the global coverage provided by The Things Network.</li>
</ul>


</div>

<div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/reference/networking/">← Networking</a>
<a class="button is-pulled-right" href="/docs/reference/packet-broker/connect/">Connect →</a>
</div>

<script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
</div>


      </div>
      <div class="column is-hidden-touch is-one-quarter is-one-fifth-widescreen sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#what-is-it'>What is it?</a></li>
    
      
      <li><a href='#who-is-it-for'>Who is it for?</a></li>
    
      
      <li><a href='#how-does-it-work'>How Does it Work?</a></li>
    
      
      <li><a href='#getting-started'>Getting Started</a></li>
    
      
      <li><a href='#lorawan-roaming-vs-packet-broker'>LoRaWAN Roaming vs Packet Broker</a></li>
    
  </ul>


  </nav>

      </div>
  </div>
</div>


<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Ben Olayinka on 01 Apr 2021.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/fe90cde987be17c42ddf1a27502cf7da7bb62578">
      doc: Change TTN to TTS Community
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/reference/packet-broker/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.595b97b16778e75a16096b7412b5ce1e7fff37a56e4e45e7f89921711a3cd177.js" integrity="sha256-WVuXsWd451oWCWt0ErXOHn//N6VuTkXn&#43;JkhcRo80Xc=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
