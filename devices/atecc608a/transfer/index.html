<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.96.0" />
  <title>Transfer to new Join Server | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/devices/atecc608a/transfer/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.c994a55269632c4bc7be3364abf857e85ff170cc251dd025099769c910cbbcb4.css" integrity="sha256-yZSlUmljLEvHvjNkq/hX6F/xcMwlHdAlCZdpyRDLvLQ=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Transfer to new Join Server">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Transfer to new Join Server">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/devices/atecc608a/transfer/">
  <meta name="twitter:title" content="Transfer to new Join Server" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.21.2</p>
      </a><div class="navbar-item navbar-search-brand">
        <div class="field has-addons has-addons-centered">
          <div class="control">
            <input id="search-input-brand" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
          </div>
        </div>
      </div>
      
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a><div class="navbar-item navbar-search-menu">
            <div class="field has-addons has-addons-centered">
              <div class="control">
                <input id="search-input-menu" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
              </div>
            </div>
          </div></div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-brand',
      debug: false 
    });
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-menu',
      debug: false 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Devices</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/devices/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/" class="">Adding Devices</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/abp-vs-otaa/" class="">ABP vs OTAA</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/best-practices/" class="">Best Practices</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/class-b/" class="">Class B</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/class-c/" class="">Class C</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/multicast/" class="">Multicast</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/downlink-queue-ops/" class="">Downlink Queue Operations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/confirmed-downlinks-behavior/" class="">Confirmed Downlinks Behavior</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/mac-settings/" class="">MAC Settings</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/atecc608a/" class="">ATECC608A/B Secure Elements</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/devices/atecc608a/claim/" class="">Claim</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/devices/atecc608a/transfer/" class="is-active">Transfer to new Join Server</a>
    
    



    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/device-claiming/" class="">Device Claiming</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/end-device-templates/" class="">End Device Templates</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/generate-qr-code/" class="">Generating a QR Code</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/the-things-node/" class="">The Things Node</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/the-things-uno/" class="">The Things Uno</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/devices/troubleshooting/" class="">Troubleshooting Devices</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Transfer to new Join Server
          
        </h1>
        
        <h2 class="subtitle">
          
            
            





  
    
  

  
    
  



  

  

<a href="/docs/download" target="_blank" class="badge-stack has-tooltip has-tooltip-arrow has-tooltip-light" data-tooltip="Cloud and Enterprise Only">

  <img class="badge" src="/docs/img/tts_frames/frame_cloud.svg"></img>

  <img class="badge" src="/docs/img/tts_frames/frame_enterprise.svg"></img>

</a>


          
          
          
          
        </h2>
        
        <div class="content">
          <p>ATECC608A/B secure elements are provisioned to The Things Join Server. This Join Server supports activation with all LoRaWAN Backend Interfaces compliant Network Servers. You don&rsquo;t need to be a user of The Things Stack to activate devices with a secure element via The Things Join Server.</p>
<p>In some scenarios, it is not feasible to use The Things Join Server. For instance, when the Network Server is deployed in a network with no internet access, when the LoRaWAN Network Server does not support the LoRaWAN Backend Interfaces, or when the LoRaWAN network operator wants to have access to the root keys.</p>
<p>To use the ATECC608A/B secure elements in these scenarios, you can transfer the root keys from The Things Join Server to a new Join Server. There are two options for doing so, which are both explained in this section.</p>
<h2 id="new-joineui">New <code>JoinEUI</code></h2>
<p>Regardless of how the root keys are transferred, a new Join Server requires a new <code>JoinEUI</code> (or <code>AppEUI</code>) for the end devices. This is because the <code>JoinEUI</code>, with which the secure elements are provisioned with, points exclusively to The Things Join Server.</p>
<p>The <code>JoinEUI</code>, just like <code>DevEUI</code>, is issued from an MAC-S (OUI-36), MAC-M (OUI-28) or MAC-L (OUI) block that can be obtained from IEEE. <a href="https://regauth.standards.ieee.org/standards-ra-web/pub/view.html#registries">Apply for an assignment</a>.</p>
<h2 id="export-root-keys">Export Root Keys</h2>
<p>The first option is to export the root keys from The Things Join Server. The root keys are normally not exposed to users, but they can be exported with the purpose of transferring to a different Join Server.</p>
<p>The requester must provide an RSA public key (see <a href="https://tools.ietf.org/html/rfc3447">RFC 3447</a>) with which The Things Join Server will encrypt the root keys with. The root keys are returned as a <a href="https://openid.net/specs/draft-jones-json-web-encryption-02.html#sec.asymmetric_encryption">JSON Web Encryption (JWE)</a> per end device.</p>
<p>Once the keys are exported, they are retained in The Things Join Server. The end devices should be deleted from The Things Join Server to ensure that activations of those devices will not be handled by The Things Join Server anymore.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Currently, this process is not readily available for self service with The Things Stack CLI or Console. Please <a href="mailto:support@thethingsindustries.com">contact The Things Industries support</a> for help.
</div>

<h2 id="rekeying">Rekeying</h2>
<div class="notification is-warning is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Warning:</h5>
  Rekeying requires LoRaWAN 1.1.1 and this specification revision is not expected to be available before Q4 2021. However, ATECC608A/B secure elements are already prepared to support the rekeying procedure.
</div>

<p>The second option is to rekey the secure elements. This works by sending an instruction to rekey to the end device as part of the LoRaWAN 1.1.1 join-accept. This instruction contains the new <code>JoinEUI</code> and a security cookie, or number used once (nonce), that the end device calculates as (non-secret) input to a key derivation function to derive new root keys. The join-accept does not contain the new root key(s): the ATECC608A/B is provisioned with a secret rekeying key from which new root keys can be derived.</p>
<p>The requester can instruct The Things Join Server to rekey the end device. The requester must provide a new <code>JoinEUI</code> pointing to the new Join Server. The Things Join Server generates a new security cookie with which it derives the new root keys. The new root keys are exported as JWE (see above), that the requester can use to import the new root keys in the new Join Server. Whenever the end device joins next, The Things Join Server will send the rekey instruction as part of the join-accept. The end device will then use the security cookie from the rekey instruction to derive the new root keys. Also, the end device sets the new <code>JoinEUI</code> from the rekey instruction. The end device will then perform a second join-request which will be answered by the new Join Server.</p>
        </div>
        <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/devices/atecc608a/claim/">← Claim</a>
<a class="button is-pulled-right" href="/docs/devices/device-claiming/">Device Claiming →</a>
</div>

        <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#new-joineui'>New JoinEUI</a></li>
    
      
      <li><a href='#export-root-keys'>Export Root Keys</a></li>
    
      
      <li><a href='#rekeying'>Rekeying</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Johan Stokking on 28 Mar 2021.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/ae37cc9a5f3ca0e2ce3c8a0e164cd2a9586b1b69">
      doc: Small textual improvements
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/devices/atecc608a/transfer.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.a32708c8796e7e8713fa926212adddbbf5c15cdd97676d898ecfc17bc6d9ed4f.js" integrity="sha256-oycIyHlufocT&#43;pJiEq3du/XBXN2XZ22Jjs/Be8bZ7U8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
