<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.96.0" />
  <title>Migrate Active Device Session | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/migrate-active-session/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.8afd1a9ba4c2f5b2a5910c50125ba2636f89937b2e7f5ca55766ed500a2a1e4f.css" integrity="sha256-iv0am6TC9bKlkQxQEluiY2&#43;Jk3suf1ylV2btUAoqHk8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Migrate Active Device Session">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Migrate Active Device Session">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/migrate-active-session/">
  <meta name="twitter:title" content="Migrate Active Device Session" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.23.1</p>
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Getting Started</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/getting-started/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/quick-start/" class="">Quick Start</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/what-is-tts/" class="">What Is The Things Stack?</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/console/" class="">Console</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/billing-and-subscription-management/" class="">Subscription and Billing Management</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cli/" class="">Command-line Interface</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/installation/" class="">Installing The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/upgrading/" class="">Upgrading The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/" class="">Migrating to The Things Stack</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/" class="">Migrating End Devices from Community Edition to Cloud</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/migrate-active-session/" class="is-active">Migrate Active Device Session</a>
    
    



    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/establish-new-session/" class="">Migrate Without Persisting Active Session</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrate-from-chirpstack/" class="">Migrating Devices from ChirpStack to The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-v2/" class="">Migrating End Devices from V2</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migration-tool/" class="">Migration Tool</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/import-devices/" class="">Import End Devices in The Things Stack</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/configure-mac-settings/" class="">Fine-tuning MAC Settings for End Devices</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/gateway-migration/" class="">Migrating Gateways</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/device-json/" class="">JSON File Reference</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/device-csv/" class="">CSV File Reference</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/faq/" class="">Migration FAQ</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cloud-hosted/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/aws/" class="">The Things Stack AWS Launcher</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/ttn/" class="">The Things Network</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/server-addresses/" class="">Server Addresses</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/" class="">Packet Broker</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/sso/" class="">Single Sign-On</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/user-management/" class="">Users and Organizations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/api/" class="">Using the API</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/events/" class="">Working with Events</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/troubleshooting/" class="">Troubleshooting Getting Started</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Migrate Active Device Session
          
        </h1>
        
        <div class="content">
          <p>This section explains how to migrate end devices from The Things Stack Community Edition to The Things Stack Cloud while persisting sessions that were already established between those devices and The Things Stack.</p>
<p>Since migrating an active session implies migrating a large number of parameters that cannot be configured manually, it is possible to do it only using the CLI or the migration tool. Migration tool support will soon be available.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Migrating devices without persisting active sessions is the preferred migration method.
</div>

<p>Read the instructions below for migrating your specific device type.</p>
<h2 id="note-on-gateway-migration">Note on Gateway Migration</h2>
<p>Even though they are both connected to <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/">Packet Broker</a>, The Things Stack Community Edition and The Things Stack Cloud use different DevAddr blocks.</p>
<p>When an active device session is migrated from The Things Stack Community Edition to The Things Stack Cloud, the DevAddr that the device was assigned with (OTAA) or programmed with (ABP) when it joined The Things Stack Community Edition will be preserved. Since Packet Broker routes traffic according to the DevAddr blocks, in case of migrating an active session to The Things Stack Cloud it won&rsquo;t be able to route your device&rsquo;s traffic properly, because your device still has its Community Edition-related DevAddr.</p>
<p>Hence, to successfully migrate an active device session from The Things Stack Community Edition to The Things Stack Cloud, you also need to migrate your gateway to The Things Stack Cloud. See instructions for <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/gateway-migration/">Migrating Gateways</a>. The ideal scenario would be to migrate your gateway and your device simultaneously, in order to not loose any traffic.</p>
<h2 id="otaa">OTAA</h2>
<p>Migrating an active OTAA device session means the OTAA device won&rsquo;t have to perform a join on The Things Stack Cloud network after its migration, i.e. the existing session that was established between the device and The Things Stack Community Edition will just be transferred to The Things Stack Cloud.</p>
<p>To migrate active OTAA device sessions from The Things Stack Community Edition to The Things Stack Cloud, follow the steps described below.</p>
<!-- placeholder for migration tool info -->
<p>First, configure your CLI to connect to The Things Stack Community Edition. See <a href="https://www.thethingsindustries.com/docs/getting-started/cli/configuring-cli/">Configuring the CLI</a> guide for instructions. Make sure you also perform a <a href="https://www.thethingsindustries.com/docs/getting-started/cli/login/">Login with the CLI</a> to The Things Stack Community Edition.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  We recommend to use the latest version of the CLI. Instructions for upgrading the CLI if you already have it installed are available in the <a href="https://www.thethingsindustries.com/docs/getting-started/cli/login/">Installing the CLI</a> guide.
</div>

<p>Now, use the CLI to export your device&rsquo;s session from The Things Stack Community Edition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-cli end-devices get --application-id &lt;app-id&gt; --device-id &lt;device-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --name <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --description <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-phy-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --frequency-plan-id <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --supports-join <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --root-keys <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-settings <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-state <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --session &gt; device-session.json
</span></span></code></pre></div><p>The command above will export your device&rsquo;s session to the <code>device-session.json</code> file in the current folder. Open the file with a text editor and remove the following fields: <code>join_server_address</code>, <code>network_server_address</code> and <code>application_server_address</code>.</p>
<p>Keep reading below the line at the end of the <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/migrating-from-ce-to-ch/migrate-active-session/#abp">ABP</a> section.</p>
<h2 id="abp">ABP</h2>
<p>Migrating an active ABP device session means the existing session that was established between the ABP device and The Things Stack Community Edition will just be transferred to The Things Stack Cloud.</p>
<p>To migrate active ABP device sessions from The Things Stack Community Edition to The Things Stack Cloud, follow the steps described below.</p>
<!-- placeholder for migration tool info -->
<p>First, configure your CLI to connect to The Things Stack Community Edition. See <a href="https://www.thethingsindustries.com/docs/getting-started/cli/configuring-cli/">Configuring the CLI</a> guide for instructions. Make sure you also perform a <a href="https://www.thethingsindustries.com/docs/getting-started/cli/login/">Login with the CLI</a> to The Things Stack Community Edition.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  We recommend to use the latest version of the CLI. Instructions for upgrading the CLI if you already have it installed are available in the <a href="https://www.thethingsindustries.com/docs/getting-started/cli/login/">Installing the CLI</a> guide.
</div>

<p>Now, use the CLI to export your device&rsquo;s session from The Things Stack Community Edition:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-cli end-devices get --application-id &lt;app-id&gt; --device-id &lt;device-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --name <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --description <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-phy-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --frequency-plan-id <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --supports-join <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-settings <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-state <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --session &gt; device-session.json
</span></span></code></pre></div><p>The command above will export your device&rsquo;s session to the <code>device-session.json</code> file in the current folder. Open the file with a text editor and remove the following fields: <code>join_server_address</code>, <code>network_server_address</code> and <code>application_server_address</code>.</p>
<hr>
<p>Before importing your device&rsquo;s session in The Things Stack Cloud, you need to completely delete your device from The Things Stack Community Edition to prevent conflicts.</p>
<p>Next, you need to import the JSON file generated above in your The Things Stack Cloud application. See instructions on how to <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/import-devices/">Import End Devices in The Things Stack</a>. Keep in mind that if you are using the CLI for import, you first have to re-configure it to connect to The Things Stack Cloud.</p>
<p>When your device&rsquo;s session is imported in The Things Stack Cloud, assuming that your gateway is also migrated to The Things Stack Cloud, you will see uplinks arriving from your device.</p>
        </div>
        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/getting-started/migrating/migrating-from-ce-to-ch/">← Migrating End Devices from Community Edition to Cloud</a>
<a class="button is-pulled-right" href="/docs/getting-started/migrating/migrating-from-ce-to-ch/establish-new-session/">Migrate Without Persisting Active Session →</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#note-on-gateway-migration'>Note on Gateway Migration</a></li>
    
      
      <li><a href='#otaa'>OTAA</a></li>
    
      
      <li><a href='#abp'>ABP</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Nejra Selimović on 01 Jun 2022.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/b96c8e75c162c24633ccfd590f6457fc61a6ac09">
      doc: Add instructions to migrate from Community Edition to Cloud (#858)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/getting-started/migrating/migrating-from-ce-to-ch/migrate-active-session/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.a32708c8796e7e8713fa926212adddbbf5c15cdd97676d898ecfc17bc6d9ed4f.js" integrity="sha256-oycIyHlufocT&#43;pJiEq3du/XBXN2XZ22Jjs/Be8bZ7U8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
