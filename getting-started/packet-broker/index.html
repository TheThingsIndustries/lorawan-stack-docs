<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Packet Broker | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.cfe865954edfe434e98142c39643957012b2f6f55c7a22b86ac263279cadc889.css" integrity="sha256-z&#43;hllU7f5DTpgULDlkOVcBKy9vVceiK4asJjJ5ytyIk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Packet Broker">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Packet Broker">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/getting-started/packet-broker/">
  <meta name="twitter:title" content="Packet Broker" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.18.2</p>
      </a><div class="navbar-item navbar-search-brand">
        <div class="field has-addons has-addons-centered">
          <div class="control">
            <input id="search-input-brand" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
          </div>
        </div>
      </div>
      
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a><div class="navbar-item navbar-search-menu">
            <div class="field has-addons has-addons-centered">
              <div class="control">
                <input id="search-input-menu" class="input search-bar" type="text" placeholder="Search the docs..." type="text">
              </div>
            </div>
          </div></div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://www.thethingsindustries.com/deployment/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript">
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-brand',
      debug: false 
    });
    docsearch({
      apiKey: "4372282a02970d8402d43457bf95d486",
      indexName: "thethingsstack",
      inputSelector: '#search-input-menu',
      debug: false 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">Getting Started</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/getting-started/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/quick-start/" class="">Quick Start</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/what-is-tts/" class="">What Is The Things Stack?</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/console/" class="">Console</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cli/" class="">Command-line Interface</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/installation/" class="">Installing The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/upgrading/" class="">Upgrading The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/migrating/" class="">Migrating to The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/cloud-hosted/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/aws/" class="">The Things Stack AWS Launcher</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/ttn/" class="">The Things Network</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/server-addresses/" class="">Server Addresses</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/" class="is-active">Packet Broker</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/connect/" class="">Connect</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/configure/" class="">Configure</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/packet-broker/troubleshooting/" class="">Troubleshooting</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/sso/" class="">Single Sign-On</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/user-management/" class="">Users and Organizations</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/api/" class="">Using the API</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/events/" class="">Working with Events</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/getting-started/troubleshooting/" class="">Troubleshooting Getting Started</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Packet Broker
          
        </h1>
        
        <div class="content">
          <h2 id="what-is-it">What is it?</h2>
<p>Packet Broker can be used to exchange traffic with other LoRaWAN networks to share coverage and improve the overall network performance.</p>
<p><img src="overview.png" alt="Overview"></p>
<p>Packet Broker supports class A and C downlink as well as OTAA device activations.</p>
<h2 id="who-is-it-for">Who is it for?</h2>
<p>Exchanging traffic can be beneficial for all public and private LoRaWAN network operators: it can improve overall network performance by increasing resilience against gateway failures, expanding coverage area and optimizing end device battery life by communicating with the nearest gateways.</p>
<h3 id="typical-use-cases">Typical Use Cases</h3>
<ol>
<li>Forward uplink traffic received by your gateways from devices to their home network. The home network may also use your gateways to transmit downlink traffic to their devices. You can also put commercial agreements in place to monetize coverage.</li>
<li>Receive uplink traffic for your devices from other networks, and use those other networks to transmit downlink traffic to your end devices.</li>
</ol>
<h2 id="how-does-it-work">How Does it Work?</h2>
<p>Packet Broker distinguishes two types of networks: Forwarders and Home Networks. Forwarders are networks with gateways: they forward uplink messages from the gateways to Packet Broker, and downlink messages from Packet Broker back to the gateways. Home Networks are networks with end devices.</p>
<p>Your The Things Stack deployment can be a Forwarder, a Home Network or both. This means that you can make your physical gateway infrastructure available to other networks without having end devices. Likewise, you can deploy end devices as a Home Network, without physical gateway infrastructure.</p>
<p>Packet Broker routes uplink messages from Forwarders to Home Networks based on the 32-bit <code>DevAddr</code> in the uplink message. The first part of the <code>DevAddr</code> is the <code>NetID</code>, a globally unique identifier of a LoRaWAN network. Packet Broker uses the <code>NetID</code> to lookup the Home Network. Besides identifying Home Networks by <code>NetID</code>, Packet Broker also supports tenants. Tenants use a <code>DevAddr</code> block of a Home Network host.</p>
<p>For example, a message with <code>DevAddr</code> <code>27ABCD12</code> has <code>NetID</code> <code>000013</code> (owned by The Things Network Foundation). The <code>DevAddr</code> block <code>27ABCD00</code> to <code>27ABCDFF</code> might be assigned to a private network <code>example-com</code>. That <code>DevAddr</code> block is noted as <code>27ABCD00/24</code>: 24 significant bits. Packet Broker identifies the Home Network then as <code>NetID</code> <code>000013</code> and tenant ID <code>example-com</code>.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  The Things Network is identified by <code>NetID</code> is <code>000013</code> and tenant ID <code>ttn</code>.
</div>

<h3 id="routing-policies">Routing Policies</h3>
<p>Routing policies define the rules that Forwarders configure for routing messages to Home Networks. Routing policies are peer-to-peer: a Forwarder can define policies with each individual Home Network. Forwarders can also define an optional default routing policy that is used as a fallback when no specific policy is defined.</p>
<p>Forwarders can configure the following message types per direction in a routing policy:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Uplink</th>
<th align="center">Downlink</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Join</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Join-request (uplink) and join-accept (downlink) messages</td>
</tr>
<tr>
<td>MAC payload</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Data messages with <code>FPort</code> <code>0</code> (for network layer instructions)</td>
</tr>
<tr>
<td>Application payload</td>
<td align="center">O</td>
<td align="center">O</td>
<td>Data messages with <code>FPort</code> <code>1</code> or higher (for application layer payload)</td>
</tr>
<tr>
<td>Signal quality</td>
<td align="center">O</td>
<td align="center"></td>
<td>RSSI and SNR information</td>
</tr>
<tr>
<td>Localization</td>
<td align="center">O</td>
<td align="center"></td>
<td>Gateway locations, timestamps and signal quality</td>
</tr>
</tbody>
</table>
<p>For instance, a Forwarder may wish to configure three policies:</p>
<ol>
<li>With Home Network that has <code>NetID</code> <code>000013</code> and tenant ID <code>ttn</code> (The Things Network): all message types. This would mean to forward join-requests and join-accepts, uplink and downlink MAC and application payload messages, and signal quality and localization information.</li>
<li>With Home Network that has <code>NetID</code> <code>000013</code> and tenant ID <code>example-com</code>: only join-requests, join-accepts and uplink and downlink MAC and application payload messages. This would mean to not forward the metadata.</li>
<li>A default policy (for all other networks): only uplink MAC and application payload messages. That would mean to not forward join-requests and join-accepts, and to not forward the metadata.</li>
</ol>
<h3 id="gateway-visibility-settings">Gateway Visibility Settings</h3>
<p>Gateway visibility configuration allows network administrators to configure who sees which gateway-related information. Having gateways listed publicly on the map can help discovering partner networks, but it may also lead to privacy concerns. Therefore, Packet Broker allows configuring gateway visibility with fine-grained settings.</p>
<p>Forwarders can configure the visibility of their gateways towards the public or specific Home Networks. Like routing policies, gateway visibility is configured peer-to-peer: a Forwarder can define gateway visibility with each individual Home Network. Forwarders can also define an optional default gateway visibility that is used as a fallback when no specific visibility is defined.</p>
<p>Forwarders can configure the following fields:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Location</td>
<td>Gateway coordinates</td>
</tr>
<tr>
<td>Antenna placement</td>
<td>Indoor/outdoor antenna placement</td>
</tr>
<tr>
<td>Antenna count</td>
<td>Number of antennas</td>
</tr>
<tr>
<td>Fine timestamps</td>
<td>Whether the gateway produces fine timestamps</td>
</tr>
<tr>
<td>Contact information</td>
<td>Administrative and technical contact information of the gateway</td>
</tr>
<tr>
<td>Status</td>
<td>Online/offline status</td>
</tr>
<tr>
<td>Frequency plan</td>
<td>Region and channel plan with frequencies that the gateway uses</td>
</tr>
<tr>
<td>Packet rates</td>
<td>Receive and transmission packet rates</td>
</tr>
</tbody>
</table>
<h2 id="getting-started">Getting Started</h2>
<p>The Things Stack Community Edition and The Things Stack Cloud are already connected to Packet Broker. Proceed to <a href="/docs/getting-started/packet-broker/configure/">Configure</a> section to manage your registration and routing policies with other networks.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  The Things Stack Community Edition and The Things Stack Cloud are configured for peering within the same geographical region. For example, The Things Stack Community Edition <code>eu1</code> cluster is configured to peer only with The Things Stack Cloud <code>eu1</code> deployments and vice versa. Peering between <code>eu1</code>, <code>au1</code> and <code>nam1</code> clusters is not currently enabled.
</div>

<p>When you are using The Things Stack Community Edition, you cannot configure any routing policies, as The Things Stack Community Edition is a public network and The Things Network Foundation controls which public or private networks the traffic gets exchanged with. To manage routing policies for your gateways, upgrade to The Things Stack Cloud.</p>
<p>When using The Things Stack Enterprise of The Things Stack Open Source, learn to <a href="/docs/getting-started/packet-broker/connect/">Connect The Things Stack to Packet Broker</a>.</p>
<h2 id="lorawan-roaming-vs-packet-broker">LoRaWAN Roaming vs Packet Broker</h2>
<p>Packet Broker is a global backbone for LoRaWAN traffic. It is designed to securely exchange traffic between LoRaWAN networks.</p>
<p>Packet Broker supports LoRaWAN passive roaming, but it goes even beyond that:</p>
<ul>
<li>Packet Broker allows for individual packet selection: networks do not get charged for traffic they did not consume.</li>
<li>Packet Broker separates traffic routing from billing and clearing: networks are free to put commercial agreements in place to settle balances.</li>
<li>Packet Broker separates payload from metadata: networks only get charged for the value they need.</li>
<li>The Things Stack has native support for Packet Broker and can access the global coverage provided by The Things Network.</li>
</ul>
<h2 id="status-page">Status Page</h2>
<p>Visit the <a href="https://status.packetbroker.net/">Packet Broker services status page</a> to check the current status of Packet Broker services. Be up do date with the recent Packet Broker upgrades, scheduled maintenances and reported incidents.</p>

        </div>
        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/getting-started/server-addresses/">← Server Addresses</a>
<a class="button is-pulled-right" href="/docs/getting-started/packet-broker/connect/">Connect →</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#what-is-it'>What is it?</a></li>
    
      
      <li><a href='#who-is-it-for'>Who is it for?</a></li>
    
      
      <li><a href='#how-does-it-work'>How Does it Work?</a></li>
    
      
      <li><a href='#getting-started'>Getting Started</a></li>
    
      
      <li><a href='#lorawan-roaming-vs-packet-broker'>LoRaWAN Roaming vs Packet Broker</a></li>
    
      
      <li><a href='#status-page'>Status Page</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Nejra Selimović on 23 Mar 2022.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/8d4295eadabd371b0c59b674cf1d476a7c315ba0">
      doc: Address improvement points from feedback (#828)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/getting-started/packet-broker/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.79500656c3860a54b3b38e5f5770a5130bc57306ebb67ca9b057e494f6f4b454.js" integrity="sha256-eVAGVsOGClSzs45fV3ClEwvFcwbrtnypsFfklPb0tFQ=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
