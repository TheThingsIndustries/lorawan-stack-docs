<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.70.0" />
  <title>Major Changes in The Things Stack | The Things Stack for LoRaWAN</title>
  <link rel="alternate icon" href="/thethingsindustries.com/docs/favicon.ico">
  <link rel="alternate icon" type="image/png" href="/thethingsindustries.com/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/thethingsindustries.com/docs/favicon.svg">
  <link rel="stylesheet" href="/thethingsindustries.com/docs/css/theme.min.f73831f1cd2827cc6e72a8e0df5a006e289e15ed508da505203eb0ef3f9e4238.css" integrity="sha256-9zgx8c0oJ8xucqjg31oAbiieFe1QjaUFID6w7z&#43;eQjg="><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  <meta name="description" content="The Things Stack for LoRaWAN">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Major Changes in The Things Stack">
  <meta itemprop="description" content="The Things Stack for LoRaWAN">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Major Changes in The Things Stack">
  <meta property="og:description" content="The Things Stack for LoRaWAN">
  <meta property="og:url" content="thethingsindustries.com/docs/getting-started/migrating-from-v2/major-changes/">
  <meta name="twitter:title" content="Major Changes in The Things Stack" />
  <meta name="twitter:description" content="The Things Stack for LoRaWAN" />
  <meta name="twitter:card" content="summary" />
</head>


<body>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/thethingsindustries.com/docs/">
        <img src="/thethingsindustries.com/docs/img/TTS-horizontal-logo.svg">
        <p class="navbar-item is-size-7">v3.10.0-dev</p>
      </a>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="thethingsindustries.com/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="thethingsindustries.com/docs/devices/">Devices</a>
        <a class="navbar-item" href="thethingsindustries.com/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="thethingsindustries.com/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="thethingsindustries.com/docs/reference/">Reference</a>
      </div>
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="button is-primary" href="thethingsindustries.com/docs/download/">Get The Things Stack</a>
        </div>
      </div>
    </div>
  </div>
</nav>
<section class="search-container">
    <div class="container">
      <div class="columns is-vcentered">
        <div class="column">
          <div class="field has-addons has-addons-centered">
            <div class="control">
              <input class="input search-bar" id="search-input" type="text" placeholder="Search" type="text">
            </div>
          </div>
        </div>
      </div>
    </div>
</section>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: "",
indexName: "thethingsstack",
inputSelector: '#search-input',
debug: false 
});
</script>

<main>
<section class="section">
  <div class="container">
    <div class="columns">
      
      <div class="column is-one-third">


<h2 class="title is-size-4">Migrating from The Things Network Stack V2</h2>

<ul class="menu-list">
<a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/" class="">Overview</a>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/major-changes/" class="is-active">Major Changes in The Things Stack</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/configure-ttnctl/" class="">Configure V2 CLI</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/export-v2-devices/" class="">Export End Devices from V2</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/import-devices/" class="">Import End Devices in The Things Stack</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/gateway-migration/" class="">Gateway Migration</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/configure-mac-settings/" class="">Fine-tuning MAC Settings for End Devices</a>
</li>
<li>
  <a href="thethingsindustries.com/docs/getting-started/migrating-from-v2/mqtt-api-comparison/" class="">V2 - V3 MQTT API comparison</a>
</li>
</ul>





      </div>
      
      <div class="column is-two-thirds">

<h1 class="title is-size-2">Major Changes in The Things Stack</h1>

<div class="content">

<p>Before getting started, we will discuss major breaking changes between The Things Network Stack V2 and The Things Stack, along with some guidelines to make the migration process easier to manage.</p>
<h2 id="architecture">Architecture</h2>
<p>The Things Stack is using a new architecture. See <a href="thethingsindustries.com/docs/reference/components/">Components</a> for a complete overview of the different components of The Things Stack.</p>
<h2 id="lorawan-support">LoRaWAN support</h2>
<p>The Things Stack requires the <strong>LoRaWAN version</strong> and <strong>Regional Parameters</strong> (LoRaWAN PHY version) to be set per end device. These default to LoRaWAN version <strong>1.0.2</strong> and LoRaWAN Regional Parameters version <strong>1.0.2 Rev B</strong> for end devices imported from The Things Network Stack V2, because this configuration is the most consistent with V2.</p>
<p>This means that all end devices need a frequency plan. You will have to choose the frequency plan corresponding to your region. See <a href="thethingsindustries.com/docs/reference/frequency-plans/">Frequency Plans</a> for a list of supported Frequency Plans and their respective IDs.</p>
<p>Furthermore, The Things Stack brings full support for all LoRaWAN versions, as well as Class B and Class C modes.</p>
<h2 id="gateway-coverage">Gateway Coverage</h2>
<p>The Packet Broker enables peering between networks, so traffic received by one network (e.g. the Public Community Network) but intended for a different network (The Things Stack) can be forwarded to and from that network. See the <a href="thethingsindustries.com/docs/integrations/peering/">Peering Guide</a> for details on Packet Broker and how to enable it for your network.</p>
<p>With Packet Broker enabled on both The Things Stack and The Things Network Stack V2, you can receive traffic on The Things Stack without having to re-configure any of your gateways.</p>
<blockquote>
<p><strong>NOTE</strong>: Packet Broker is only enabled on The Things Network Public Community Network and The Things Industries Cloud Hosted.</p>
</blockquote>
<p>For private The Things Stack deployments with Packet Broker disabled, you will need to re-configure your gateways to connect to The Things Stack, so that you can start receiving traffic from your end devices.</p>
<p>In order to connect a gateway to The Things Stack, follow instructions for <a href="thethingsindustries.com/docs/gateways/adding-gateways/">Adding Gateways</a>. Then, reconfigure the gateway to connect to The Things Stack, and regenerate its API key (if required).</p>
<p>Also see <a href="thethingsindustries.com/docs/gateways/">Gateways</a> for instructions on configuring popular LoRaWAN gateways with The Things Stack.</p>
<h2 id="application-data">Application Data</h2>
<p>The Things Stack uses a different data format for uplink and downlink traffic than The Things Network Stack V2.</p>
<p>For details on the data format of The Things Network Stack V2, see the documentation from <a href="https://www.thethingsnetwork.org/docs/applications/mqtt/api.html">The Things Network</a>.</p>
<p>For details on the data format of The Things Stack, see the documentation in <a href="thethingsindustries.com/docs/integrations/data-formats/">Data Formats</a>. It uses a different schema, different names, and has much richer metadata support.</p>
<p><strong>When migrating to The Things Stack, ensure your application can properly handle the new The Things Stack data format.</strong></p>
<h3 id="payload-formats">Payload Formats</h3>
<p>The Things Network Stack V2 has support for payload decoders, converters, validators (for uplink) and encoders (for downlink). These can be either CayenneLPP or Javascript functions.</p>
<p>The Things Stack has support for an uplink payload formatter (similar to the payload decoder) and a downlink payload formatter (similar to the payload encoder). These can be set per application, and can even be overridden per end device. Similar to The Things Network Stack V2, CayenneLPP and Javascript functions are supported.</p>
<p>Migrating the The Things Network Stack V2 payload encoder and decoder to an uplink and downlink payload formatter should be straightforward. See <a href="thethingsindustries.com/docs/integrations/payload-formatters/">Payload Formatters</a> for more details.</p>
<h3 id="integrations">Integrations</h3>
<p><a href="thethingsindustries.com/docs/integrations/">Read about the Integrations supported by The Things Stack</a>.</p>
<h4 id="mqtt-traffic">MQTT Traffic</h4>
<p>You will need to change the MQTT server your application connects to. The Things Stack has a new MQTT server address. You will also need to create API keys and update your MQTT credentials accordingly.</p>
<p>Read more on <a href="thethingsindustries.com/docs/integrations/mqtt/">MQTT Server</a>.</p>
<h4 id="webhooks">Webhooks</h4>
<p>The HTTP Integration is now called HTTP Webhooks. The payload format, downlink endpoints, paths and security settings have changed.</p>
<p>Read more on <a href="thethingsindustries.com/docs/integrations/webhooks/">HTTP Webhooks</a>.</p>
<h4 id="storage-integration">Storage Integration</h4>
<p>The Things Stack does not currently support a Storage integration similar to The Things Network Stack V2. This feature will be added in a future release.</p>
<h2 id="suggested-migration-process">Suggested Migration Process</h2>
<p><strong>First</strong>: Update applications to support the The Things Stack data format. If you are using payload formatters, make sure to set them correctly from the Application settings page.</p>
<p><strong>Second</strong>: Follow this guide in order to migrate a single end device (and gateway, if needed) to The Things Stack. Continue by gradually migrating your end devices in small batches. Avoid migrating production workloads before you are certain that they will work as expected.</p>
<p><strong>Finally</strong>: Once you are confident that your end devices are working properly, migrate the rest of your devices and gateways to The Things Stack.</p>
</div>

<script>window.emojicom_widget = { campaign: "" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
<div class="is-clearfix">
<a class="button is-pulled-left" href="thethingsindustries.com/docs/getting-started/migrating-from-v2/">← Migrating from The Things Network Stack V2</a>
<a class="button is-pulled-right" href="thethingsindustries.com/docs/getting-started/migrating-from-v2/configure-ttnctl/">Configure V2 CLI →</a>
</div>


      </div>
    </div>
  </div>
</section>
</main>

<footer class="footer has-background-primary">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="thethingsindustries.com/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="thethingsindustries.com/docs/devices/">Devices</a></p>
        <p><a class="" href="thethingsindustries.com/docs/gateways/">Gateways</a></p>
        <p><a class="" href="thethingsindustries.com/docs/integrations/">Integrations</a></p>
        <p><a class="" href="thethingsindustries.com/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsNetwork/lorawan-stack">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/network-and-routing/v3">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="has-text-light is-size-7">
  Last changed by Ben Olayinka on 22 Oct 2020.
  <br>
  <a href="https://github.com/TheThingsNetwork/lorawan-stack/commit/6b4daa186a9360e72e50edfe36c09fa7cdf05c68">
      Merge pull request #31 from TheThingsIndustries/util/build-workflow
    </a>
</p>

<a href="https://github.com/TheThingsNetwork/lorawan-stack/blob/default/doc/content/getting-started/migrating-from-v2/major-changes.md" class="button is-primary is-small is-inverted is-outlined">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="/thethingsindustries.com/docs/js/theme.min.4feb1389331adbef9047157f884dbdbd63af1c61ac83f327e60eef42f999cb26.js" integrity="sha256-T&#43;sTiTMa2&#43;&#43;QRxV/iE29vWOvHGGsg/Mn5g7vQvmZyyY="></script><script>
  window.intercomSettings = {
    app_id: "",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
