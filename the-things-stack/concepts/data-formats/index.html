<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.96.0" />
  <title>Data Formats | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/data-formats/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.8058c473c43c01571dbb7b1b4de287fb8e077613d282e9b7b9db17271211dd60.css" integrity="sha256-gFjEc8Q8AVcdu3sbTeKH&#43;44HdhPSgum3udsXJxIR3WA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Data Formats">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Data Formats">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/the-things-stack/concepts/data-formats/">
  <meta name="twitter:title" content="Data Formats" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.24.2</p>
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/the-things-stack/">The Things Stack</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">The Things Stack</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/the-things-stack/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/" class="">Basic Concepts</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/architecture/" class="">Architecture</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/spec-regional-parameters/" class="">LoRaWAN Specification and Regional Parameters</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/data-formats/" class="is-active">Data Formats</a>
    
    



    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/networking/" class="">Networking</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/server-addresses/" class="">Server Addresses</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/cloud/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/host/" class="">Host The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/" class="">Interact with The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/" class="">Manage The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/" class="">Migrate to The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/packet-broker/" class="">Packet Broker</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/troubleshooting/" class="">Troubleshooting</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Data Formats
          
        </h1>
        
        <div class="content">
          <p>The streaming data integrations provide multiple formats for the delivery of application uplink messages and downlink queue operations. This section will delve into the common formats used by them.</p>
<p>Read about LoRaWANÂ® message types in <a href="https://www.thethingsnetwork.org/docs/lorawan/message-types/">The Things Network documentation</a>.</p>
<h2 id="json">JSON</h2>
<p>The JSON message format is described in the sections below.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Empty fields are omitted from payloads. As such, if a certain field has a value of <code>&quot;&quot;</code>, <code>0</code> or <code>false</code> it will not be present in the message.
</div>

<h3 id="join-accept-messages">Join-accept Messages</h3>
<p>The JSON join-accept messages use the following format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;end_device_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>                    <span class="c1">// Device ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;application_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;application_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;app1&#34;</span>              <span class="c1">// Application ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;dev_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>          <span class="c1">// DevEUI of the end device
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;join_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>         <span class="c1">// JoinEUI of the end device (also known as AppEUI in LoRaWAN versions below 1.1)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;dev_addr&#34;</span> <span class="o">:</span> <span class="s2">&#34;00BCB929&#34;</span>                  <span class="c1">// Device address known by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:up:01...&#34;</span> <span class="p">],</span>     <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;received_at&#34;</span> <span class="o">:</span> <span class="s2">&#34;2020-02-12T15:15...&#34;</span>      <span class="c1">// ISO 8601 UTC timestamp at which the message has been received by the Application Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;join_accept&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;session_key_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;AXBSH1Pk6Z0G166...&#34;</span><span class="p">,</span> <span class="c1">// Join Server issued identifier for the session keys
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;received_at&#34;</span> <span class="o">:</span> <span class="s2">&#34;2020-02-17T07:49...&#34;</span>    <span class="c1">// ISO 8601 UTC timestamp at which the uplink has been received by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><details><summary>Join message example</summary>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;end_device_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;device_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;application_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;application_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;app1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;join_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_addr&#34;</span> <span class="p">:</span> <span class="s2">&#34;01497ECC&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;as:up:01E191YN5F2HMBQCBCVRF731VY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:conn:01E191S6ZEWB630NTR45K5QN4Q&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:uplink:01E191YMZ2S7ZRTEGATVE2S3HH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ns:uplink:01E191YMZ2J64K6FEW5F0WE7TQ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01E191YMZ2KK3TJYG5C4XZP8JK&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;received_at&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-17T07:49:09.935284891Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;join_accept&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session_key_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;AXBSH1Pk6Z0G166RlH16CQ==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;received_at&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-17T07:49:09.736532315Z&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></details>
<h3 id="uplink-messages">Uplink Messages</h3>
<p>The JSON uplink messages use the following format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;end_device_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>                    <span class="c1">// Device ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;application_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;application_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;app1&#34;</span>              <span class="c1">// Application ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;dev_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>          <span class="c1">// DevEUI of the end device
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;join_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>         <span class="c1">// JoinEUI of the end device (also known as AppEUI in LoRaWAN versions below 1.1)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;dev_addr&#34;</span> <span class="o">:</span> <span class="s2">&#34;00BCB929&#34;</span>                  <span class="c1">// Device address known by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:up:01...&#34;</span><span class="p">,</span> <span class="p">...</span> <span class="p">],</span><span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;received_at&#34;</span> <span class="o">:</span> <span class="s2">&#34;2020-02-12T15:15...&#34;</span>      <span class="c1">// ISO 8601 UTC timestamp at which the message has been received by the Application Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;uplink_message&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;session_key_id&#34;</span><span class="o">:</span> <span class="s2">&#34;AXA50...&#34;</span><span class="p">,</span>            <span class="c1">// Join Server issued identifier for the session keys used by this uplink
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;f_cnt&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>                              <span class="c1">// Frame counter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;f_port&#34;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>                             <span class="c1">// Frame port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;frm_payload&#34;</span><span class="o">:</span> <span class="s2">&#34;gkHe&#34;</span><span class="p">,</span>                   <span class="c1">// Frame payload (Base64)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;decoded_payload&#34;</span> <span class="o">:</span> <span class="p">{</span>                    <span class="c1">// Decoded payload object, decoded by the device payload formatter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;temperature&#34;</span><span class="o">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;luminosity&#34;</span><span class="o">:</span> <span class="mf">0.64</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;rx_metadata&#34;</span><span class="o">:</span> <span class="p">[{</span>                        <span class="c1">// A list of metadata for each antenna of each gateway that received this message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;gateway_ids&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;gateway_id&#34;</span><span class="o">:</span> <span class="s2">&#34;gtw1&#34;</span><span class="p">,</span>                <span class="c1">// Gateway ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;eui&#34;</span><span class="o">:</span> <span class="s2">&#34;9C5C8E00001A05C4&#34;</span>            <span class="c1">// Gateway EUI
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;time&#34;</span><span class="o">:</span> <span class="s2">&#34;2020-02-12T15:15:45.787Z&#34;</span><span class="p">,</span>    <span class="c1">// ISO 8601 UTC timestamp at which the uplink has been received by the gateway
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;timestamp&#34;</span><span class="o">:</span> <span class="mi">2463457000</span><span class="p">,</span>               <span class="c1">// Timestamp of the gateway concentrator when the message has been received
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;rssi&#34;</span><span class="o">:</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span>                           <span class="c1">// Received signal strength indicator (dBm)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;channel_rssi&#34;</span><span class="o">:</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span>                   <span class="c1">// Received signal strength indicator of the channel (dBm)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;snr&#34;</span><span class="o">:</span> <span class="mf">5.2</span><span class="p">,</span>                            <span class="c1">// Signal-to-noise ratio (dB)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;uplink_token&#34;</span><span class="o">:</span> <span class="s2">&#34;ChIKEA...&#34;</span><span class="p">,</span>           <span class="c1">// Uplink token injected by gateway, Gateway Server or fNS
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;channel_index&#34;</span><span class="o">:</span> <span class="mi">2</span>                     <span class="c1">// Index of the gateway channel that received the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;location&#34;</span><span class="o">:</span> <span class="p">{</span>                          <span class="c1">// Gateway location metadata (only for gateways with location set to public)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;latitude&#34;</span><span class="o">:</span> <span class="mf">37.97155556731436</span><span class="p">,</span>       <span class="c1">// Location latitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;longitude&#34;</span><span class="o">:</span> <span class="mf">23.72678801175413</span><span class="p">,</span>      <span class="c1">// Location longitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;altitude&#34;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>                       <span class="c1">// Location altitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;source&#34;</span><span class="o">:</span> <span class="s2">&#34;SOURCE_REGISTRY&#34;</span>          <span class="c1">// Location source. SOURCE_REGISTRY is the location from the Identity Server.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;settings&#34;</span><span class="o">:</span> <span class="p">{</span>                            <span class="c1">// Settings for the transmission
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;data_rate&#34;</span><span class="o">:</span> <span class="p">{</span>                         <span class="c1">// Data rate settings
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;lora&#34;</span><span class="o">:</span> <span class="p">{</span>                            <span class="c1">// LoRa modulation settings
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="s2">&#34;bandwidth&#34;</span><span class="o">:</span> <span class="mi">125000</span><span class="p">,</span>               <span class="c1">// Bandwidth (Hz)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="s2">&#34;spreading_factor&#34;</span><span class="o">:</span> <span class="mi">7</span>              <span class="c1">// Spreading factor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;coding_rate&#34;</span><span class="o">:</span> <span class="s2">&#34;4/6&#34;</span><span class="p">,</span>                  <span class="c1">// LoRa coding rate
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;frequency&#34;</span><span class="o">:</span> <span class="s2">&#34;868300000&#34;</span><span class="p">,</span>              <span class="c1">// Frequency (Hz)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;received_at&#34;</span><span class="o">:</span> <span class="s2">&#34;2020-02-12T15:15...&#34;</span>     <span class="c1">// ISO 8601 UTC timestamp at which the uplink has been received by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;consumed_airtime&#34;</span><span class="o">:</span> <span class="s2">&#34;0.056576s&#34;</span><span class="p">,</span>         <span class="c1">// Time-on-air, calculated by the Network Server using payload size and transmission settings
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;locations&#34;</span><span class="o">:</span> <span class="p">{</span>                           <span class="c1">// End device location metadata
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;user&#34;</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;latitude&#34;</span><span class="o">:</span> <span class="mf">37.97155556731436</span><span class="p">,</span>       <span class="c1">// Location latitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;longitude&#34;</span><span class="o">:</span> <span class="mf">23.72678801175413</span><span class="p">,</span>      <span class="c1">// Location longitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;altitude&#34;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>                      <span class="c1">// Location altitude
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;source&#34;</span><span class="o">:</span> <span class="s2">&#34;SOURCE_REGISTRY&#34;</span>          <span class="c1">// Location source. SOURCE_REGISTRY is the location from the Identity Server.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;version_ids&#34;</span><span class="o">:</span> <span class="p">{</span>                          <span class="c1">// End device version information
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;brand_id&#34;</span><span class="o">:</span> <span class="s2">&#34;the-things-products&#34;</span><span class="p">,</span>    <span class="c1">// Device brand
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;model_id&#34;</span><span class="o">:</span> <span class="s2">&#34;the-things-uno&#34;</span><span class="p">,</span>         <span class="c1">// Device model
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;hardware_version&#34;</span><span class="o">:</span> <span class="s2">&#34;1.0&#34;</span><span class="p">,</span>            <span class="c1">// Device hardware version
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;firmware_version&#34;</span><span class="o">:</span> <span class="s2">&#34;quickstart&#34;</span><span class="p">,</span>     <span class="c1">// Device firmware version
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="s2">&#34;band_id&#34;</span><span class="o">:</span> <span class="s2">&#34;EU_863_870&#34;</span>               <span class="c1">// Supported band ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;network_ids&#34;</span><span class="o">:</span> <span class="p">{</span>                          <span class="c1">// Network information
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;net_id&#34;</span><span class="o">:</span> <span class="s2">&#34;000013&#34;</span><span class="p">,</span>                     <span class="c1">// Network ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;tenant_id&#34;</span><span class="o">:</span> <span class="s2">&#34;tenant1&#34;</span><span class="p">,</span>                 <span class="c1">// Tenant ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;cluster_id&#34;</span><span class="o">:</span> <span class="s2">&#34;eu1&#34;</span>                     <span class="c1">// Cluster ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;simulated&#34;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>                         <span class="c1">// Signals if the message is coming from the Network Server or is simulated.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><details><summary>Uplink message example</summary>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;end_device_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;device_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;application_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;application_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;app1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;join_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_addr&#34;</span> <span class="p">:</span> <span class="s2">&#34;00BCB929&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;as:up:01E0WZGT6Y7657CPFPE5WEYDSQ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:conn:01E0WDEC6T5T4XXBAX7S1VMFKE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:uplink:01E0WZGSZWT07NE5TS2APTV1Z9&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ns:uplink:01E0WZGSZXZXZS8RFAWZX0F2FY&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01E0WZGSZXGE1KS577PFBWRJEE&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;received_at&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-12T15:15:46.014773143Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;uplink_message&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session_key_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;AXA50tHUGUucuzS/bCGMNw==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;f_cnt&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;frm_payload&#34;</span> <span class="p">:</span> <span class="s2">&#34;gkHe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;decoded_payload&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;temperature&#34;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;luminosity&#34;</span><span class="p">:</span> <span class="mf">0.64</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;rx_metadata&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;gateway_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;gateway_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;gtw1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;9C5C8E00001A05C4&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;time&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-12T15:15:45.787Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;timestamp&#34;</span> <span class="p">:</span> <span class="mi">2463457000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;rssi&#34;</span> <span class="p">:</span> <span class="mi">-35</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;channel_rssi&#34;</span> <span class="p">:</span> <span class="mi">-35</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;snr&#34;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;uplink_token&#34;</span> <span class="p">:</span> <span class="s2">&#34;ChIKEAoEZ3R3MRIInFyOAAAaBcQQ6L3Vlgk=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;channel_index&#34;</span> <span class="p">:</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;settings&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;data_rate&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;lora&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;bandwidth&#34;</span> <span class="p">:</span> <span class="mi">125000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;spreading_factor&#34;</span> <span class="p">:</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;coding_rate&#34;</span> <span class="p">:</span> <span class="s2">&#34;4/6&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;frequency&#34;</span> <span class="p">:</span> <span class="s2">&#34;868300000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;timestamp&#34;</span> <span class="p">:</span> <span class="mi">2463457000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;time&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-12T15:15:45.787Z&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;consumed_airtime&#34;</span><span class="p">:</span> <span class="s2">&#34;0.056576s&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;locations&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;user&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;latitude&#34;</span><span class="p">:</span> <span class="mf">37.97155556731436</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;longitude&#34;</span><span class="p">:</span> <span class="mf">23.72678801175413</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;altitude&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source&#34;</span><span class="p">:</span> <span class="s2">&#34;SOURCE_REGISTRY&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;version_ids&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;brand_id&#34;</span><span class="p">:</span> <span class="s2">&#34;the-things-products&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;model_id&#34;</span><span class="p">:</span> <span class="s2">&#34;the-things-uno&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;hardware_version&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;firmware_version&#34;</span><span class="p">:</span> <span class="s2">&#34;quickstart&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;band_id&#34;</span><span class="p">:</span> <span class="s2">&#34;US_902_928&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;network_ids&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;net_id&#34;</span><span class="p">:</span> <span class="s2">&#34;000013&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;tenant_id&#34;</span><span class="p">:</span> <span class="s2">&#34;tenant1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;cluster_id&#34;</span><span class="p">:</span> <span class="s2">&#34;nam1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;received_at&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-12T15:15:45.789585559Z&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></details>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  <p>End device key-value attributes are not included in uplink messages, because these attributes are stored in the Identity Server and normally they are static, so sending that data with every uplink is inefficient. Users can instead fetch device&rsquo;s attributes using the API:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl --request GET /
</span></span><span class="line"><span class="cl">  --location <span class="s1">&#39;https://thethings.example.com/api/v3/applications/&lt;application-id&gt;/devices/&lt;device-id&gt;?field_mask=attributes&#39;</span> /
</span></span><span class="line"><span class="cl">  --header <span class="s2">&#34;Authorization: Bearer &lt;api-key&gt;&#34;</span>
</span></span></code></pre></div>
</div>

<h3 id="downlink-events-messages">Downlink Events Messages</h3>
<p>The JSON downlink <code>ack</code>, <code>nack</code>, <code>queued</code> and <code>sent</code> events messages use the following format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;end_device_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>                    <span class="c1">// Device ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;application_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;application_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;app1&#34;</span>              <span class="c1">// Application ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;dev_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>          <span class="c1">// DevEUI of the end device
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;join_eui&#34;</span> <span class="o">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>         <span class="c1">// JoinEUI of the end device (also known as AppEUI in LoRaWAN versions below 1.1)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;dev_addr&#34;</span> <span class="o">:</span> <span class="s2">&#34;00BCB929&#34;</span>                  <span class="c1">// Device address known by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink:...&#34;</span> <span class="p">],</span> <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;received_at&#34;</span> <span class="o">:</span> <span class="s2">&#34;2020-02-17T10:32:24...&#34;</span><span class="p">,</span>  <span class="c1">// ISO 8601 UTC timestamp at which the message has been received by the Network Server
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;downlink_queued&#34;</span> <span class="o">:</span> <span class="p">{</span>                      <span class="c1">// Name of the event (ack, nack, queued or sent)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;session_key_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;AXBSH1Pk6Z0G166...&#34;</span><span class="p">,</span> <span class="c1">// Join Server issued identifier for the session keys
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;f_port&#34;</span> <span class="o">:</span> <span class="mi">15</span><span class="p">,</span>                           <span class="c1">// Frame port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;f_cnt&#34;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>                             <span class="c1">// Frame counter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;frm_payload&#34;</span> <span class="o">:</span> <span class="s2">&#34;vu8=&#34;</span><span class="p">,</span>                  <span class="c1">// Frame payload (Base64)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;confirmed&#34;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>                      <span class="c1">// If the downlink expects a confirmation from the device or not
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;priority&#34;</span> <span class="o">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>                   <span class="c1">// Priority of the message in the downlink queue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink...&#34;</span> <span class="p">]</span> <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><details><summary>Downlink event message example</summary>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;end_device_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;device_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;application_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;application_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;app1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;0004A30B001C0530&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;join_eui&#34;</span> <span class="p">:</span> <span class="s2">&#34;800000000000000C&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dev_addr&#34;</span> <span class="p">:</span> <span class="s2">&#34;00C30DFA&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;as:downlink:01E19B99501X84X6CV471TVSZ1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;as:up:01E19B9J8ED6HZW5CC41KPGHVD&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:conn:01E191S6ZEWB630NTR45K5QN4Q&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;gs:uplink:01E19B9J17SRJWJ4GV3MCJHNWZ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ns:uplink:01E19B9J1CG3QNWS5M8G3DBMPN&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;rpc:/ttn.lorawan.v3.GsNs/HandleUplink:01E19B9J17K85MJ1MXPHTW0410&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;received_at&#34;</span> <span class="p">:</span> <span class="s2">&#34;2020-02-17T10:32:24.590413417Z&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;downlink_ack&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;session_key_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;AXBSp8v2brG0jqkri+sIkw==&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;f_port&#34;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;f_cnt&#34;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;frm_payload&#34;</span> <span class="p">:</span> <span class="s2">&#34;vu8=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;confirmed&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;priority&#34;</span> <span class="p">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink:01E19B99501X84X6CV471TVSZ1&#34;</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></details>
<p>The JSON downlink <code>failed</code> event provides both the downlink and the error details, in the following format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;end_device_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>                    <span class="c1">// Device ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;application_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;application_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;app1&#34;</span>              <span class="c1">// Application ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink:...&#34;</span> <span class="p">],</span> <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="s2">&#34;downlink_failed&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;downlink&#34;</span> <span class="o">:</span> <span class="p">{</span>                           <span class="c1">// Downlink that which triggered the failure
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;f_port&#34;</span> <span class="o">:</span> <span class="mi">15</span><span class="p">,</span>                         <span class="c1">// Frame port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;frm_payload&#34;</span> <span class="o">:</span> <span class="s2">&#34;YWFhYWFhY...&#34;</span><span class="p">,</span>        <span class="c1">// Frame payload (Base64)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;confirmed&#34;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>                    <span class="c1">// If the downlink expects a confirmation from the device or not
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;priority&#34;</span> <span class="o">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>                 <span class="c1">// Priority of the message in the downlink queue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;as:downli...&#34;</span> <span class="p">]</span> <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;error&#34;</span> <span class="o">:</span> <span class="p">{</span>                              <span class="c1">// Error that was encountered while sending the downlink
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;namespace&#34;</span> <span class="o">:</span> <span class="s2">&#34;pkg/networkserver&#34;</span><span class="p">,</span>     <span class="c1">// Component in which the error occurred
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;name&#34;</span> <span class="o">:</span> <span class="s2">&#34;application_downlink_to...&#34;</span><span class="p">,</span> <span class="c1">// Error ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;message_format&#34;</span> <span class="o">:</span> <span class="s2">&#34;application ...&#34;</span><span class="p">,</span>  <span class="c1">// Error message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;correlation_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;2e7f786912e94...&#34;</span><span class="p">,</span> <span class="c1">// Correlation identifiers of the error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;code&#34;</span> <span class="o">:</span> <span class="mi">3</span>                             <span class="c1">// gRPC error code
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><details><summary>Downlink failed event message example</summary>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;end_device_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;device_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;application_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;application_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;app1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink:01E19Z5W3BZBG7CXSJE9C0A3CE&#34;</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;downlink_failed&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;downlink&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;f_port&#34;</span> <span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;frm_payload&#34;</span> <span class="p">:</span> <span class="s2">&#34;vu8=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;confirmed&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;priority&#34;</span> <span class="p">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;as:downlink:01E19Z5W3BZBG7CXSJE9C0A3CE&#34;</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;error&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;namespace&#34;</span> <span class="p">:</span> <span class="s2">&#34;pkg/networkserver&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;application_downlink_too_long&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;message_format&#34;</span> <span class="p">:</span> <span class="s2">&#34;application downlink payload is too long&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;correlation_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;2e7f786912e946e597894e381d0ad7b0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;code&#34;</span> <span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></details>
<h3 id="downlink-messages">Downlink Messages</h3>
<p>The JSON downlink messages use the following format:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;end_device_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>                    <span class="c1">// Device ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;application_ids&#34;</span> <span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;application_id&#34;</span> <span class="o">:</span> <span class="s2">&#34;app1&#34;</span>              <span class="c1">// Application ID
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;downlinks&#34;</span><span class="o">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;f_port&#34;</span><span class="o">:</span> <span class="mi">15</span><span class="p">,</span>                            <span class="c1">// Frame port
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;frm_payload&#34;</span><span class="o">:</span> <span class="s2">&#34;vu8=&#34;</span><span class="p">,</span>                   <span class="c1">// Frame payload (Base64)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;decoded_payload&#34;</span> <span class="o">:</span> <span class="p">{</span>                    <span class="c1">// Decoded payload object, to be encoded by the device payload formatter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;temperature&#34;</span><span class="o">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;luminosity&#34;</span><span class="o">:</span> <span class="mf">0.64</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;priority&#34;</span><span class="o">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>                    <span class="c1">// Priority of the message in the downlink queue
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;confirmed&#34;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>                       <span class="c1">// If the downlink expects a confirmation from the device or not
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="s2">&#34;correlation_ids&#34;</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;custom-id&#34;</span> <span class="p">]</span>      <span class="c1">// Correlation identifiers of the message
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The end device identifiers need to be supplied only to frontends that do not derive it from other sources (such as the URL for webhooks or topic name for MQTT).</p>
<details><summary>Downlink message example</summary>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;end_device_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;device_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;dev1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;application_ids&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;application_id&#34;</span> <span class="p">:</span> <span class="s2">&#34;app1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;downlinks&#34;</span><span class="p">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;f_port&#34;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;frm_payload&#34;</span><span class="p">:</span> <span class="s2">&#34;vu8=&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;decoded_payload&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;temperature&#34;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;luminosity&#34;</span><span class="p">:</span> <span class="mf">0.64</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;priority&#34;</span><span class="p">:</span> <span class="s2">&#34;NORMAL&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;confirmed&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;correlation_ids&#34;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;custom-id&#34;</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></details>
        </div>
        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/the-things-stack/concepts/spec-regional-parameters/">â LoRaWAN Specification and Regional Parameters</a>
<a class="button is-pulled-right" href="/docs/the-things-stack/concepts/networking/">Networking â</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#json'>JSON</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/the-things-stack/">The Things Stack</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Krishna Iyer on 19 Apr 2023.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/7b36a78abab91e6a6967b41f03b65551a89e54c9">
      Restructure documentation (#1076)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/the-things-stack/concepts/data-formats/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.a32708c8796e7e8713fa926212adddbbf5c15cdd97676d898ecfc17bc6d9ed4f.js" integrity="sha256-oycIyHlufocT&#43;pJiEq3du/XBXN2XZ22Jjs/Be8bZ7U8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
