<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.96.0" />
  <title>Single Sign-On | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.8058c473c43c01571dbb7b1b4de287fb8e077613d282e9b7b9db17271211dd60.css" integrity="sha256-gFjEc8Q8AVcdu3sbTeKH&#43;44HdhPSgum3udsXJxIR3WA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Single Sign-On">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Single Sign-On">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/">
  <meta name="twitter:title" content="Single Sign-On" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
</head>


<body><nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
        <p class="navbar-item is-size-7">v3.24.2</p>
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/the-things-stack/">The Things Stack</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://accounts.thethingsindustries.com/fee-calculator">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">The Things Stack</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/the-things-stack/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/" class="">Basic Concepts</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/cloud/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/host/" class="">Host The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/" class="">Interact with The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/" class="">Manage The Things Stack</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/" class="is-active">Single Sign-On</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/cognito/" class="">Amazon Cognito</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/google/" class="">Google OpenID Connect</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/user-management/" class="">Users and Organizations</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/events/" class="">Working with Events</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/purge/" class="">Purging Entities</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/telemetry/" class="">Telemetry</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/tenant-management/" class="">Tenant Management</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/branding/" class="">Web UI Branding</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/" class="">Migrate to The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/packet-broker/" class="">Packet Broker</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/troubleshooting/" class="">Troubleshooting</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Single Sign-On
          
        </h1>
        
        <h2 class="subtitle">
          
            
            





  
    
  

  
    
  



  

  

<a href="/docs/getting-started/what-is-tts#the-things-stack-deployments" target="_blank" class="badge-stack has-tooltip has-tooltip-arrow has-tooltip-light" data-tooltip="Cloud and Enterprise Only">

  <img class="badge" src="/docs/img/tts_frames/frame_cloud.svg"></img>

  <img class="badge" src="/docs/img/tts_frames/frame_enterprise.svg"></img>

</a>


          
          
          
          
        </h2>
        
        <div class="content">
          <p>The Things Stack supports <a href="https://openid.net/connect/">OpenID Connect</a> for single sign-on. This section contains instructions for connecting an OpenID provider to your The Things Stack deployment to allow users to sign in with their existing credentials.</p>
<div class="notification is-primary is-light has-text-dark">
  <h3 class="title has-text-dark mb-1">Command-line interface only</h3>
  <p>The instructions below use the command-line interface (CLI).</p>
  
  
  <div class="buttons">
    <a class="button is-dark is-outlined" href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/installing-cli/">Learn how to install the CLI</a>
  </div>
</div>

<h2 id="requirements">Requirements</h2>
<ol>
<li>Access to an OpenID Connect provider such as Google or Amazon Cognito</li>
<li>Administrator access to your The Things Stack deployment</li>
<li><a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/"><code>tti-lw-cli</code></a></li>
</ol>
<h2 id="configure-your-openid-connect-provider">Configure Your OpenID Connect Provider</h2>
<p>First, you must configure your OpenID Connect Provider to accept login requests from The Things Stack and to forward authentication to the callback address of your The Things Stack deployment.</p>
<p>The Things Stack requires the following from the OpenID Connect Provider:</p>
<ul>
<li>OpenID Discovery Address</li>
<li>Client ID</li>
<li>Client Secret</li>
</ul>
<p>And you must enter the following in the OpenID Connect Provider configuration:</p>
<ul>
<li>Callback URL</li>
</ul>
<p>See instructions for configuring <a href="/docs/the-things-stack/management/sso/google/">Google</a> and <a href="/docs/the-things-stack/management/sso/cognito/">Amazon Cognito</a> OpenID Connect Providers.</p>
<h3 id="callback-url">Callback URL</h3>
<p>The callback URL (or Redirect URI in Google terminology) of your The Things Stack deployment is the <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/server-addresses/">Server Address</a> followed by the OAuth endpoint, which includes an <strong>Authentication Provider ID</strong> of your choosing:</p>
<p><code>/oauth/login/&lt;authentication-provider-id&gt;/callback</code></p>
<p>You will actually create the Authentication Provider in The Things Stack using this Authentication Provider ID, so remember it.</p>
<p>For example, with a tenant <code>tenant1</code> in the <code>eu1</code> cluster and an Authentication Provider ID of <code>auth-provider</code>, the OAuth Callback URL is:</p>
<p><code>https://tenant1.eu1.cloud.thethings.industries/oauth/login/auth-provider/callback</code></p>
<h2 id="configure-the-things-stack-for-sso">Configure The Things Stack for SSO</h2>
<p>Once your OpenID Connect provider is configured, you can configure The Things Stack.</p>
<p>Use the following command (note that Authentication Provider commands are only available in <code>tti-lw-cli</code>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ tti-lw-cli authentication-providers create &lt;authentication-provider-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--allow-registrations <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.client-id &lt;client-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.client-secret &lt;client-secret&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.provider-url &lt;provider-url&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--name &lt;display-name&gt;
</span></span></code></pre></div><p>The <code>name</code> is what will appear on The Things Stack login screen. For example, to register a Google OpenID Authentication Provider, using the <code>id</code> goog and <code>name</code> Goog:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ tti-lw-cli authentication-providers create goog <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--allow-registrations <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.client-id xxxxx-vq3v4e2ha7c1668mr92iiqu0bd1spct2.apps.googleusercontent.com <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.client-secret GOCSPX-Vxxxxxxx <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--configuration.provider.oidc.provider-url https://accounts.google.com <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>--name Goog
</span></span></code></pre></div><p>A list of provider discovery URLs is available from AWS <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pools-oidc-idp.html#cognito-user-pools-oidc-idp-step-1">here</a>.</p>
<p>If succesful, <code>tti-lw-cli</code> will return a list of Authentication Providers. When you go to login, you will see the login option using the <code>name</code> you registered the Authentication Provider with.</p>
<figure><img src="login-screen.png"/>
</figure>

<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="i-get-the-email-not-verified-error-when-logging-in-using-sso">I get the <code>email not verified</code> error when logging in using SSO.</h3>
<p>The Things Stack checks if the email address included in the JWT token has been verified by the OIDC provider (e.g. The Things ID or SSO DB), so the JWT token that the OIDC provider provides should contain the <code>email_verified</code> field. If this field is not present, the user might face the following error upon logging in with SSO:</p>
<pre tabindex="0"><code>{
&#34;code&#34;: 7,
&#34;message&#34;: &#34;error:pkg/account/oidc:unverified_email (email not verified)&#34;,
&#34;details&#34;: [
    {
        &#34;@type&#34;: &#34;type.googleapis.com/ttn.lorawan.v3.ErrorDetails&#34;,
        &#34;namespace&#34;: &#34;pkg/account/oidc&#34;,
        &#34;name&#34;: &#34;unverified_email&#34;,
        &#34;message_format&#34;: &#34;email not verified&#34;,
        &#34;correlation_id&#34;: &#34;43c2ea63620d4487b64723d03195953e&#34;,
        &#34;code&#34;: 7
    }]
}
</code></pre><p>To fix this error, users should ask their OIDC provider to include the <code>email_verified</code> field in the JWT token to be used with The Things Stack SSO.</p>
        </div>
        
          <div class="columns is-multiline">
  <div class="column is-half is-flex">
    <div class="card has-radius is-fullwidth">
      <div class="card-content">
        <div class="title-content">
          <h1 class="title is-size-5 is-uppercase"><a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/cognito/">Amazon Cognito</a>
          </h1>
          
          <div class="content has-text-grey">
            
            This section contains instructions to configure Amazon Cognito to work with The Things Stack.
Configuring OpenID Connect with Amazon Cognito will allow single sign-on from any account within a Cognito user pool.
Create a User Pool From the Amazon Cognito Management Page, choose Manage User Pools.
 Click Create a user pool in the top right.
 Give the user pool a name of your choosing. You will not need this later, you may pick any name.
            
          </div>
        </div>
        <div class="buttons">
          <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/cognito/" class="button is-primary is-outlined">Read</a>
        </div>
      </div>
    </div>
  </div>
  <div class="column is-half is-flex">
    <div class="card has-radius is-fullwidth">
      <div class="card-content">
        <div class="title-content">
          <h1 class="title is-size-5 is-uppercase"><a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/google/">Google OpenID Connect</a>
          </h1>
          
          <div class="content has-text-grey">
            
            This section contains instructions to configure Google OpenID Connect to work with The Things Stack.
Configuring OpenID Connect with your Google account will allow single sign-on from any account within your Google organization. This requires administrator rights to that organization.
Create an OAuth Client ID From the Google Cloud Console, navigate to APIs and Services, and choose Credentials in the left hand menu.
Click Create Credentials and choose OAuth client ID.
            
          </div>
        </div>
        <div class="buttons">
          <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/sso/google/" class="button is-primary is-outlined">Read</a>
        </div>
      </div>
    </div>
  </div>
</div>

        
          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/the-things-stack/management/">← Manage The Things Stack</a>
<a class="button is-pulled-right" href="/docs/the-things-stack/management/sso/cognito/">Amazon Cognito →</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#requirements'>Requirements</a></li>
    
      
      <li><a href='#configure-your-openid-connect-provider'>Configure Your OpenID Connect Provider</a></li>
    
      
      <li><a href='#configure-the-things-stack-for-sso'>Configure The Things Stack for SSO</a></li>
    
      
      <li><a href='#troubleshooting'>Troubleshooting</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-quarter">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/the-things-stack/">The Things Stack</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
      </nav>
      <nav class="column is-one-quarter">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
        <p><a class="" href="https://www.thethingsnetwork.org/forum/c/ttn-network/v3/90">Forum</a></p>
      </nav>
      
      <nav class="column is-one-quarter">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsnetwork.org">The Things Network</a></p>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      <div class="column is-one-quarter">
        <h3 class="title is-6">About this page</h3>
        <div class="content">
<p class="is-size-7">
  Last changed by Krishna Iyer on 19 Apr 2023.
  <br>
  <a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/commit/7b36a78abab91e6a6967b41f03b65551a89e54c9">
      Restructure documentation (#1076)
    </a>
</p>

<a href="https://github.com/TheThingsIndustries/lorawan-stack-docs/blob/master/doc/content/the-things-stack/management/sso/_index.md" class="button">Edit on Github</a>
</div>

      </div>
    </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.a32708c8796e7e8713fa926212adddbbf5c15cdd97676d898ecfc17bc6d9ed4f.js" integrity="sha256-oycIyHlufocT&#43;pJiEq3du/XBXN2XZ22Jjs/Be8bZ7U8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
