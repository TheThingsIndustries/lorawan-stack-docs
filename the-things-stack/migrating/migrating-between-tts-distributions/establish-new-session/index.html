<!DOCTYPE html>

<html class="has-navbar-fixed-top">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="generator" content="Hugo 0.112.3">
  <title>Migrate Without Persisting Active Session | The Things Stack for LoRaWAN</title><link rel="canonical" href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-between-tts-distributions/establish-new-session/" />
  <link rel="alternate icon" type="image/png" href="/docs/favicon.png">
  <link rel="icon" type="image/svg+xml" href="/docs/favicon.svg">
  <link rel="stylesheet" href="https://www.thethingsindustries.com/docs/css/theme.min.5ba0be8f5f0e953584382f5875ae6ec65f7a9a9cda0dea27bd9ddb1025d10fa5.css" integrity="sha256-W6C&#43;j18OlTWEOC9Yda5uxl96mpzaDeonvZ3bECXRD6U=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta itemprop="name" content="Migrate Without Persisting Active Session">
  <meta itemprop="description" content="">
  <meta itemprop="keywords" content="">
  <meta property="og:title" content="Migrate Without Persisting Active Session">
  <meta property="og:description" content="">
  <meta property="og:url" content="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-between-tts-distributions/establish-new-session/">
  <meta property="og:image" content="/docs/docs-thumbnail.png"/>
  <meta name="twitter:title" content="Migrate Without Persisting Active Session" />
  <meta name="twitter:description" content="" />
  <meta name="twitter:card" content="summary" />
  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NGRDCNM');</script>



  <link rel="stylesheet" href="https://ttui.thethingsindustries.com/release/1.7.2/main.css" />
</head>


<body class="theme-tts">


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NGRDCNM"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="container is-fluid">
    <div class="navbar-brand">
      <a class="navbar-item" href="/docs/">
        <img class="logo" src="/docs/img/TTS-logo.svg">
      </a><div class="navbar-item navbar-search-menu" id="search-input-menu">
          </div>
      <span class="navbar-burger burger" data-target="topMenu">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </div>
    <div id="topMenu" class="navbar-menu">
      <div class="navbar-start">
        <a class="navbar-item" href="/docs/getting-started/">Getting Started</a>
        <a class="navbar-item" href="/docs/devices/">Devices</a>
        <a class="navbar-item" href="/docs/gateways/">Gateways</a>
        <a class="navbar-item" href="/docs/the-things-stack/">The Things Stack</a>
        <a class="navbar-item" href="/docs/integrations/">Integrations</a>
        <a class="navbar-item" href="/docs/reference/">Reference</a>
        <a class="navbar-item" href="/docs/api/">API</a>

      </div>
      <div class="navbar-end"><div class="navbar-item">
            <a class="button is-primary" href="https://www.thethingsindustries.com/stack/plans/">Get The Things Stack</a>
          </div>
      </div>
    </div>
  </div>
</nav><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
  <script type="text/javascript">
    docsearch({
      appId: "608OILUBK2",
      apiKey: "39082cdce449b93b2aa806b44f6af4d2",
      indexName: "thethingsstack",
      container: '#search-input-menu',
      debug: false, 
    });
  </script><div class="container" role="document">
  <div class="columns my-0 ">
      
      <div class="column is-3 is-2-desktop sidebar-left">
        

<nav class="side-navigation" aria-label="Main navigation">

<h2 class="title is-size-5">The Things Stack</h2>

<ul class="menu-list">
<a href="https://www.thethingsindustries.com/docs/the-things-stack/" class="">Overview</a>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/concepts/" class="">Basic Concepts</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/cloud/" class="">The Things Stack Cloud</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/host/" class="">Host The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/" class="">Interact with The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/management/" class="">Manage The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/" class="">Migrate to The Things Stack</a>
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-between-tts-distributions/" class="">Migrating End Devices between The Things Stack distributions</a>
    
    


<ul class="menu-list">

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-between-tts-distributions/establish-new-session/" class="is-active">Migrate Without Persisting Active Session</a>
    
    



    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-between-tts-distributions/migrate-active-session/" class="">Migrate Active Device Session</a>
    
  </li>

</ul>


    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/" class="">Migration Tool</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migrating-from-v2/" class="">Migrating End Devices from V2</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/configure-mac-settings/" class="">Fine-tuning MAC Settings for End Devices</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/gateway-migration/" class="">Migrating Gateways</a>
    
  </li>

  <li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/faq/" class="">Migration FAQ</a>
    
  </li>

</ul>


    
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/packet-broker/" class="">Packet Broker</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/works-with/" class="">Works with The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/alerting/" class="">Alerting in The Things Stack</a>
  </li>
<li>
    <a href="https://www.thethingsindustries.com/docs/the-things-stack/troubleshooting/" class="">Troubleshooting</a>
  </li>
</ul>



</nav>








      </div>
      
      <div class="column is-9 is-8-desktop sidebar-middle">
        <div class="docs-content">
        <h1 class="title is-size-2">Migrate Without Persisting Active Session
          
        </h1>
        
        <div class="content">
          <p>This section explains how to migrate end devices from The Things Stack Sandbox to The Things Stack Cloud without persisting sessions that were established between those devices and The Things Stack Sandbox. This is the way to go if you cannot migrate your gateway from The Things Stack Sandbox to The Things Stack Cloud.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  Migrating devices without persisting active sessions is the preferred migration method.
</div>

<h3 id="note-on-temporarily-preserving-uplink-traffic-on-the-things-stack-sandbox">Note on temporarily preserving uplink traffic on The Things Stack Sandbox</h3>
<p>In this section, we consider migrating your devices in cases when you don&rsquo;t want to migrate your gateway from The Things Stack Sandbox to The Things Stack Cloud, or when your gateway is inaccessible for this migration. In those cases, devices are migrated from The Things Stack Sandbox to The Things Stack Cloud without persisting their active session, i.e. devices need to establish a new session with The Things Stack Cloud in order for a gateway (that wasn&rsquo;t migrated from The Things Stack Sandbox) to be able to route traffic from those devices to The Things Stack Cloud. More information about this is available in subsections below.</p>
<p>For a new session to be established between device (that&rsquo;s currently connected to The Things Stack Sandbox) and The Things Stack Cloud, device has to perform a <a href="https://www.thethingsindustries.com/docs/reference/components/join-server/#join-procedure">join procedure</a> to register on The Things Stack Cloud. In order not to lose any uplink traffic during this join procedure, we suggest to disable scheduling downlink messages on The Things Stack Sandbox Network Server using the following <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/">CLI</a> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-cli dev <span class="nb">set</span> --application-id &lt;app-id&gt; --device-id &lt;device-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-settings.schedule-downlinks<span class="o">=</span><span class="nb">false</span>
</span></span></code></pre></div><p>When the end device gets triggered to perform a new join on The Things Stack Cloud, the uplink traffic will still reach The Things Stack Sandbox until device is actually registered on Cloud. Using the command above, we make sure that we disable The Things Stack Sandbox Network Server to send Join Accept messages, data downlinks or MAC commands to device, i.e. we make sure that device doesn&rsquo;t get re-registered on The Things Stack Sandbox, but registered on The Things Stack Cloud.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  The <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/">migration tool</a> does this automatically when migrating devices so you don&rsquo;t need to worry about disabling the downlinks of exported devices.
</div>

<p>Now, you can proceed with migrating your device. Read the instructions below to migrate your OTAA or ABP devices.</p>
<p>When your device is finally migrated, it will be assigned with a DevAddr issued by The Things Stack Cloud, so the old session between device and The Things Stack Sandbox will no longer exist, i.e. uplinks will no longer reach The Things Stack Sandbox, just The Things Stack Cloud.</p>
<h2 id="migrate-otaa-devices">Migrate OTAA Devices</h2>
<p>Migrating an OTAA device without persisting its active session means the device will establish a new session with The Things Stack Cloud, i.e. it will have to perform a new join on The Things Stack Cloud network after migration. The device will negotiate about network parameters with The Things Stack Cloud Network Server, and during that negotiation, the device will be assigned with a new DevAddr from The Things Stack Cloud DevAddr block.</p>
<p>Since The Things Stack Sandbox and The Things Stack Cloud are both connected to Packet Broker, Packet Broker will be able to route your device&rsquo;s traffic to The Things Stack Cloud even if your gateway stays connected to The Things Stack Sandbox, i.e. you don&rsquo;t have to migrate your gateway to The Things Stack Cloud, only your device. However, if you want to migrate your gateway to The Things Stack Cloud too, see <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/gateway-migration/">Migrating Gateways</a> for instructions.</p>
<p>To migrate your OTAA device from The Things Stack Sandbox to The Things Stack Cloud without an active session, choose your preferred method and follow the steps described below.</p>
<div class="tabs is-boxed">
  <ul>
    
    <li data-tab="migration-tool">
      <a>
        <span>Migration tool</span>
      </a>
    </li>
    
    <li data-tab="console">
      <a>
        <span>Console</span>
      </a>
    </li>
    
    <li data-tab="cli">
      <a>
        <span>CLI</span>
      </a>
    </li>
    
  </ul>
</div>
<div class="tab-content content">
  <section data-content="migration-tool">
  <p>For detailed instructions on how to configure the migration tool before exporting your device and how to adjust the following command for migrating multiple devices or whole applications, head over to <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/export-from-tts/">Export Devices from The Things Stack</a>.</p>
<p>To export device using the <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/">migration tool</a> without persisting active session, use the <code>--tts.no-session</code> flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-migrate device --source tts <span class="s1">&#39;my-device&#39;</span> --tts.no-session &gt; devices.json
</span></span></code></pre></div><p>Next, you need to import the <code>devices.json</code> file in your The Things Stack Cloud application. See instructions on how to <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/adding-devices-in-bulk/">add end devices in bulk in The Things Stack</a>. Keep in mind that if you are using the CLI to import devices, you have to configure it to connect to The Things Stack Cloud. See <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions.</p>
<p>The process of migrating OTAA devices using the migration tool ends here and you can ignore the info below the line.</p>
</section>
<section data-content="console">
  <p>Using the Console is convenient only when you have a few devices to migrate. For larger groups of devices, we highly recommend using the <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/">migration tool</a> or CLI.</p>
<p>First step is to recreate your device on The Things Stack Cloud through the Console. See <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/">Adding Devices</a> for instructions on creating a device. You can reuse the DevEUI, AppEUI/JoinEUI and AppKey values from The Things Stack Sandbox. You can also generate new values for these parameters on The Things Stack Cloud, but then you will need to re-program your OTAA device using those values.</p>
</section>
<section data-content="cli">
  <p>First, configure your CLI to connect to The Things Stack Sandbox. See <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions. Make sure you also perform a <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/login/">Login with the CLI</a> to The Things Stack Sandbox.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  We recommend to use the latest version of the CLI. Instructions for upgrading the CLI if you already have it installed are available in the <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/installing-cli/">Installing the CLI</a> guide.
</div>
<p>Now, use the CLI to export your device&rsquo;s description from The Things Stack Sandbox:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-cli end-devices get --application-id &lt;app-id&gt; --device-id &lt;device-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --name <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --description <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-phy-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --frequency-plan-id <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --supports-join <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --root-keys <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-settings &gt; device-description.json
</span></span></code></pre></div><p>The command above will export your device&rsquo;s description to the <code>device-description.json</code> file in the current folder. Open the file with a text editor and remove the following fields: <code>join_server_address</code>, <code>network_server_address</code> and <code>application_server_address</code>.</p>
<p>Next, you need to import the <code>device-description.json</code> file in your The Things Stack Cloud application. See instructions on how to <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/adding-devices-in-bulk/">add end devices in bulk in The Things Stack</a>. Keep in mind that if you are using the CLI to import devices, you first have to re-configure it to connect to The Things Stack Cloud. Again, see <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions.</p>
</section>

</div>

<hr>
<p>When your device is registered in The Things Stack Cloud, you need to prevent it from re-joining The Things Stack Sandbox network. To do so, you can change your OTAA device&rsquo;s AppKey on The Things Stack Sandbox (under device&rsquo;s <strong>General settings → Join Settings → AppKey</strong>) or completely delete your device from The Things Stack Sandbox.</p>
<p>Finally, your device needs to perform a new join on The Things Stack Cloud network. Some OTAA devices will perform an automatic re-join after they are deleted from The Things Stack Sandbox, but some devices need to be triggered, e.g. by sending a downlink to it, by power cycling it, etc. You should see a Join Request from your device coming in The Things Stack Cloud.</p>
<p>After joining The Things Stack Cloud network, you will see uplinks arriving from your device.</p>
<h2 id="migrate-abp-devices">Migrate ABP Devices</h2>
<p>Migrating an ABP device without persisting its active session means its session and MAC state parameters will be reset, or the device will be completely re-programmed with new session parameters.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  For ABP devices, we advise to re-program the device using session parameters that are newly generated on The Things Stack Cloud, if possible. For devices that can be re-programmed, it is also recommended to change their activation method from ABP to OTAA.
</div>

<p>Let&rsquo;s first assume that you are able to re-program your ABP device with new DevAddr, NwkSKey and AppSKey issued by The Things Stack Cloud.</p>
<p>Since The Things Stack Sandbox and The Things Stack Cloud are both connected to Packet Broker, and your ABP device will be re-programmed with a new DevAddr from The Things Stack Cloud DevAddr block, Packet Broker will be able to route your device&rsquo;s traffic to The Things Stack Cloud even if your gateway stays connected to The Things Stack Sandbox, i.e. you don&rsquo;t have to migrate your gateway to The Things Stack Cloud, only your device. However, if you want to migrate your gateway to The Things Stack Cloud too, see <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/gateway-migration/">Migrating Gateways</a> for instructions.</p>
<p>The process of migrating your ABP device from The Things Stack Sandbox to The Things Stack Cloud without its active session by re-programming it is the most straightforward if you use the The Things Stack Console.</p>
<p>First create a new ABP device on The Things Stack Cloud. See <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/">Adding Devices</a> for instructions on creating a device. Generate new DevAddr, AppSKey and NwkSKey values while creating the device.</p>
<p>Now re-program your ABP device with newly created DevAddr, AppSKey and NwkSKey values from The Things Stack Cloud. You should immediately see uplinks arriving from your device to The Things Stack Cloud.</p>
<p>However, if you don&rsquo;t want to re-program your device, i.e. you want to keep the DevAddr, AppSKey and NwkSKey from The Things Stack Sandbox, read the instructions below.</p>
<hr>
<p>Now let&rsquo;s assume that you want to migrate your ABP device to The Things Stack Cloud in such manner that it keeps its DevAddr, NwkSKey and AppSKey it was programmed with upon its registration on The Things Stack Sandbox network.</p>
<p>Note that The Things Stack Sandbox and The Things Stack Cloud use different DevAddr blocks. Since Packet Broker routes traffic according to the DevAddr blocks, in this case it won&rsquo;t be able to route your device&rsquo;s traffic properly, because of the The Things Stack Sandbox-related DevAddr. To successfully migrate your ABP device while keeping these parameters, you also need to migrate your gateway to The Things Stack Cloud. See instructions for <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/gateway-migration/">Migrating Gateways</a>. The ideal scenario would be to migrate your gateway and your device simultaneously.</p>
<p>To migrate your ABP device with preserving its DevAddr, NwkSKey and AppSKey, from The Things Stack Sandbox to The Things Stack Cloud, follow the steps described below. Keep in mind that the existing session will be violated because you will need to reset frame counters for your device, hence we refer to this as migrating without an active session.</p>
<div class="tabs is-boxed">
  <ul>
    
    <li data-tab="migration-tool">
      <a>
        <span>Migration tool</span>
      </a>
    </li>
    
    <li data-tab="console">
      <a>
        <span>Console</span>
      </a>
    </li>
    
    <li data-tab="cli">
      <a>
        <span>CLI</span>
      </a>
    </li>
    
  </ul>
</div>
<div class="tab-content content">
  <section data-content="migration-tool">
  <p>For detailed instructions on how to configure the migration tool before exporting your device and how to adjust the following commands for migrating multiple devices or whole applications, head over to <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/export-from-tts/">Export Devices from The Things Stack</a>.</p>
<p>To export devices using the <a href="https://www.thethingsindustries.com/docs/the-things-stack/migrating/migration-tool/">migration tool</a> without persisting active session, use the <code>--tts.no-session</code> flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-migrate device --source tts <span class="s1">&#39;my-device&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --tts.no-session &gt; devices.json
</span></span></code></pre></div><p>Next, you need to import the <code>devices.json</code> file in your The Things Stack Cloud application. See instructions on how to <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/adding-devices-in-bulk/">add end devices in bulk in The Things Stack</a>. Keep in mind that if you are using the CLI to import devices, you first have to configure it to connect to The Things Stack Cloud. See <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions.</p>
<p>You will also need to reset your ABP device.</p>
<p>When your device is finally registered in The Things Stack Cloud, you need to completely delete it from The Things Stack Sandbox network to prevent conflicts. You can do this by running the following command with <code>--tts.delete-source-device</code> flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-migrate device --source tts <span class="s1">&#39;my-device&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --tts.delete-source-device
</span></span></code></pre></div>
</section>
<section data-content="console">
  <p>Using the Console is covenient only when you have a few devices to migrate. For larger groups of devices, we highly recommend using the migration tool or the CLI.</p>
<p>First, recreate your device on The Things Stack Cloud. See <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/">Adding Devices</a> for instructions on creating a device. Reuse the DevEUI, DevAddr, AppSKey and NwkSKey values from The Things Stack Sandbox.</p>
<p>Navigate to <strong>General settings → Network Layer → Advanced MAC settings</strong> and enable the <strong>Resets frame counters</strong> option.</p>
<p>When your device is registered in The Things Stack Cloud, you need to completely delete it from The Things Stack Sandbox network to prevent conflicts. You will also need to reset your ABP device.</p>
</section>
<section data-content="cli">
  <p>First, configure your CLI to connect to The Things Stack Sandbox. See <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions. Make sure you also perform a <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/login/">Login with the CLI</a> to The Things Stack Sandbox.</p>
<div class="notification is-info is-light has-text-dark">
  <h5 class="title is-family-sans-serif has-text-dark mb-1">Note:</h5>
  We recommend to use the latest version of the CLI. Instructions for upgrading the CLI if you already have it installed are available in the <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/installing-cli/">Installing the CLI</a> guide.
</div>
<p>Now, use the CLI to export your device&rsquo;s description from The Things Stack Sandbox:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ttn-lw-cli end-devices get --application-id &lt;app-id&gt; --device-id &lt;device-id&gt; <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --name
</span></span><span class="line"><span class="cl">    --description
</span></span><span class="line"><span class="cl">    --lorawan-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --lorawan-phy-version <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --frequency-plan-id <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --supports-join <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --root-keys <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --mac-settings <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --session.dev-addr <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --session.keys &gt; device-description.json
</span></span></code></pre></div><p>The command above will export your device&rsquo;s description to the <code>device-description.json</code> file in the current folder. Open the file with a text editor and remove the following fields: <code>join_server_address</code>, <code>network_server_address</code> and <code>application_server_address</code>. Also, set the <code>mac-settings.resets-f-cnt</code> field value to <code>true</code>.</p>
<p>Next, you need to import the <code>device-description.json</code> file in your The Things Stack Cloud application. See instructions on how to <a href="https://www.thethingsindustries.com/docs/devices/adding-devices/adding-devices-in-bulk/">add end devices in bulk in The Things Stack</a>. Keep in mind that if you are using the CLI to import devices, you first have to re-configure it to connect to The Things Stack Cloud. Again, see <a href="https://www.thethingsindustries.com/docs/the-things-stack/interact/cli/configuring-cli/">Configuring the CLI</a> guide for instructions.</p>
<p>When your device is registered in The Things Stack Cloud, you need to completely delete it from The Things Stack Sandbox network to prevent conflicts. You will also need to reset your ABP device.</p>
</section>

</div>

<p>If you also migrated your gateway, you will immediately see uplinks arriving from your device.</p>
        </div>
          <div class="columns is-multiline">
</div>

          <div class="is-clearfix">
<a class="button is-pulled-left" href="/docs/the-things-stack/migrating/migrating-between-tts-distributions/">← Migrating End Devices between The Things Stack distributions</a>
<a class="button is-pulled-right" href="/docs/the-things-stack/migrating/migrating-between-tts-distributions/migrate-active-session/">Migrate Active Device Session →</a>
</div>

          <script>window.emojicom_widget = { campaign: "NEDHszRC2r2KaGj1mhj7" };</script>
<script src="https://cdn.emojicom.io/embed/widget.js" async></script>

<div class='feedback has-vertical-space'>
  <div id="emojicom-widget-inline"></div>
</div>
        </div>
      </div>
      
      <div class="column is-hidden-touch is-2-desktop sidebar-right">
        <nav class="toc" aria-label="Page navigation">
    <h2 class="title is-size-6">On this page</h2>
    


  <ul class="menu-list">
    
      
      <li><a href='#migrate-otaa-devices'>Migrate OTAA Devices</a></li>
    
      
      <li><a href='#migrate-abp-devices'>Migrate ABP Devices</a></li>
    
  </ul>


  </nav>

      </div>
      
  </div>
</div>



<footer class="footer">
  <div class="container">
    <div class="columns">
      <nav class="column is-one-third">
        <h3 class="title is-6">The Things Stack</h3>
        <p><a class="" href="/docs/getting-started/">Getting Started</a></p>
        <p><a class="" href="/docs/devices/">Devices</a></p>
        <p><a class="" href="/docs/gateways/">Gateways</a></p>
        <p><a class="" href="/docs/the-things-stack/">The Things Stack</a></p>
        <p><a class="" href="/docs/integrations/">Integrations</a></p>
        <p><a class="" href="/docs/reference/">Reference</a></p>
        <p><a class="" href="/docs/api/">API</a></p>
      </nav>
      <nav class="column is-one-third">
        <h3 class="title is-6">Contributing</h3>
        <p><a class="" href="https://github.com/TheThingsIndustries/lorawan-stack-docs">GitHub</a></p>
      </nav>
      
      <nav class="column is-one-third">
        <h3 class="title is-6">About Us</h3>
        <p><a class="" href="https://www.thethingsindustries.com">The Things Industries</a></p>
      </nav>
      </div>
  </div>
</footer>
<script src="https://www.thethingsindustries.com/docs/js/vendor/basicLightbox.min.js"></script>
<script src="https://www.thethingsindustries.com/docs/js/theme.min.4a22f0dea0620048bc258cf6dedbdfbec40f3b5dba1dcdc6536e61e7bc20a5bf.js" integrity="sha256-SiLw3qBiAEi8JYz23tvfvsQPO126Hc3GU25h57wgpb8=" crossorigin="anonymous"></script><script>
  window.intercomSettings = {
    app_id: "pp8esr7h",
  };
</script>

<script>
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/pp8esr7h';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>

</body>

</html>
